(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0f6c8c63"],{"0636":function(e,t,a){e.exports=a.p+"static/web/img/receive-task.e1131038.svg"},"11fe":function(e,t,a){e.exports=a.p+"static/web/img/icon_receive.a6c46918.svg"},"1bb8":function(e,t,a){e.exports=a.p+"static/web/img/user-task.90bd34cf.svg"},"238c":function(e,t,a){},"2a9f4":function(e,t,a){e.exports=a.p+"static/web/img/parallel-gateway.dfb4ebaf.svg"},"2d36":function(e,t,a){e.exports=a.p+"static/web/img/icon_script.07c7423e.svg"},"2f27":function(e,t,a){e.exports=a.p+"static/web/img/exclusive-gateway.56b82dfd.svg"},"31ac":function(e,t,a){e.exports=a.p+"static/web/img/icon_signal.0e96b3b6.svg"},"390a":function(e,t,a){},"3f28":function(e,t,a){},6858:function(e,t,a){},"8a11":function(e,t,a){"use strict";a("3f28")},"974b":function(e,t,a){e.exports=a.p+"static/web/img/end.9687f898.svg"},ba02:function(e,t,a){e.exports=a.p+"static/web/img/icon_message.01031aed.svg"},bc51:function(e,t,a){"use strict";a("390a")},bd84:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"root"},[e.isView?e._e():t("ToolbarPanel",{ref:"toolbar"}),e._v(" "),t("div",{staticStyle:{display:"flex"}},[e.isView?e._e():t("ItemPanel",{ref:"addItemPanel",attrs:{height:e.height}}),e._v(" "),t("div",{ref:"canvas",staticClass:"canvasPanel",style:{height:e.height+"px",width:e.isView?"100%":"70%","border-bottom":e.isView?0:null}}),e._v(" "),e.isView?e._e():t("DetailPanel",{ref:"detailPanel",attrs:{height:e.height,model:e.selectedModel,"read-only":"edit"!==e.mode,users:e.users,roles:e.roles,groups:e.groups,departments:e.departments,tasks:e.tasks,templates:e.templates,"templates-base":e.templatesBase,"template-infos":e.templateInfos,"field-infos":e.fieldInfos,"signal-defs":e.processModel.signalDefs,"message-defs":e.processModel.messageDefs,"on-change":function(t,a){e.onItemCfgChange(t,a)}}})],1)],1)},s=[],i=a("bd86"),o=(a("55dd"),a("db72")),l=(a("ac6a"),a("c5f6"),a("9d67")),r=a.n(l);function c(e){switch(e){case"start":return"start-node";case"end":return"end-node";case"gateway":return"gateway-node";case"exclusiveGateway":return"exclusive-gateway-node";case"parallelGateway":return"parallel-gateway-node";case"inclusiveGateway":return"inclusive-gateway-node";case"timerStart":return"timer-start-node";case"messageStart":return"message-start-node";case"signalStart":return"signal-start-node";case"userTask":return"user-task-node";case"scriptTask":return"script-task-node";case"mailTask":return"mail-task-node";case"javaTask":return"java-task-node";case"receiveTask":return"receive-task-node";case"timerCatch":return"timer-catch-node";case"messageCatch":return"message-catch-node";case"signalCatch":return"signal-catch-node";default:return"task-node"}}a("7f7f");var d=a("d225"),u=a("b0b4"),p=a("503e"),h=a("e0ef"),g=a("3421"),m=function(){function e(){Object(d["a"])(this,e)}return Object(u["a"])(e,[{key:"getDefaultCfg",value:function(){return{_command:{zoomDelta:.1,queue:[],current:0,clipboard:[]}}}},{key:"get",value:function(e){return this._cfgs[e]}},{key:"set",value:function(e,t){this._cfgs[e]=t}},{key:"initPlugin",value:function(e){var t=this;this._cfgs=this.getDefaultCfg(),this.list=[],this.queue=[],this.initCommands(),e.getCommands=function(){return t.get("_command").queue},e.getCurrentCommand=function(){var e=t.get("_command");return e.queue[e.current-1]},e.executeCommand=function(a,n){t.execute(a,e,n)},e.commandEnable=function(a){return t.enable(a,e)}}},{key:"registerCommand",value:function(e,t){if(this[e])p(this[e],t);else{var a=p({},{name:e,shortcutCodes:[],queue:!0,executeTimes:1,init:function(){},enable:function(){return!0},execute:function(e){this.snapShot=e.save(),this.selectedItems=e.get("selectedItems"),this.method&&(g(this.method)?e[this.method]():this.method(e))},back:function(e){e.read(this.snapShot),e.set("selectedItems",this.selectedItems)}},t);this[e]=a,this.list.push(a)}}},{key:"execute",value:function(e,t,a){var n=p({},this[e],a),s=this.get("_command");return n.enable(t)&&(n.init(),n.queue&&(s.queue.splice(s.current,s.queue.length-s.current,n),s.current++)),t.emit("beforecommandexecute",{command:n}),n.execute(t),t.emit("aftercommandexecute",{command:n}),n}},{key:"enable",value:function(e,t){return this[e].enable(t)}},{key:"destroyPlugin",value:function(){this._events=null,this._cfgs=null,this.list=[],this.queue=[],this.destroyed=!0}},{key:"initCommands",value:function(){var e=this;e.registerCommand("add",{enable:function(){return this.type&&this.addModel},execute:function(e){var t=e.add(this.type,this.addModel);1===this.executeTimes&&(this.addId=t.get("id"))},back:function(e){e.remove(this.addId)}}),e.registerCommand("update",{enable:function(){return this.itemId&&this.updateModel},execute:function(e){var t=e.findById(this.itemId);t&&(1===this.executeTimes&&(this.originModel=p({},t.getModel())),e.update(t,this.updateModel))},back:function(e){var t=e.findById(this.itemId);e.update(t,this.originModel)}}),e.registerCommand("delete",{enable:function(e){var t=e.getCurrentMode(),a=e.get("selectedItems");return"edit"===t&&a&&a.length>0},method:function(e){var t=e.get("selectedItems");e.emit("beforedelete",{items:t}),t&&t.length>0&&t.forEach((function(t){return e.remove(t)})),e.emit("afterdelete",{items:t})},shortcutCodes:["Delete","Backspace"]}),e.registerCommand("redo",{queue:!1,enable:function(t){var a=t.getCurrentMode(),n=e.get("_command");return"edit"===a&&n.current<n.queue.length},execute:function(t){var a=e.get("_command"),n=a.queue[a.current];n&&n.execute(t),a.current++},shortcutCodes:[["metaKey","shiftKey","z"],["ctrlKey","shiftKey","z"]]}),e.registerCommand("undo",{queue:!1,enable:function(t){var a=t.getCurrentMode();return"edit"===a&&e.get("_command").current>0},execute:function(t){var a=e.get("_command"),n=a.queue[a.current-1];n&&(n.executeTimes++,n.back(t)),a.current--},shortcutCodes:[["metaKey","z"],["ctrlKey","z"]]}),e.registerCommand("copy",{queue:!1,enable:function(e){var t=e.getCurrentMode(),a=e.get("selectedItems");return"edit"===t&&a&&a.length>0},method:function(t){var a=e.get("_command");a.clipboard=[];var n=t.get("selectedItems");if(n&&n.length>0){var s=t.findById(n[0]);s&&a.clipboard.push({type:s.get("type"),model:s.getModel()})}}}),e.registerCommand("paste",{enable:function(t){var a=t.getCurrentMode();return"edit"===a&&e.get("_command").clipboard.length>0},method:function(t){var a=e.get("_command");this.pasteData=h(a.clipboard[0]);var n=this.pasteData.model;n.x&&(n.x+=10),n.y&&(n.y+=10);var s=n.clazz,i=void 0===s?"userTask":s,o=(new Date).getTime(),l=i+o;n.id=l;var r=t.add(this.pasteData.type,n);r.toFront()}}),e.registerCommand("zoomIn",{queue:!1,enable:function(e){var t=e.getZoom(),a=e.get("maxZoom"),n=e.get("minZoom");return t<=a&&t>=n},execute:function(t){var a=e.get("_command"),n=t.get("maxZoom"),s=t.getZoom();this.originZoom=s;var i=s+a.zoomDelta;i>n&&(i=n),t.zoomTo(i)},back:function(e){e.zoomTo(this.originZoom)},shortcutCodes:[["metaKey","="],["ctrlKey","="]]}),e.registerCommand("zoomOut",{queue:!1,enable:function(e){var t=e.getZoom(),a=e.get("maxZoom"),n=e.get("minZoom");return t<=a&&t>=n},execute:function(t){var a=e.get("_command"),n=t.get("minZoom"),s=t.getZoom();this.originZoom=s;var i=s-a.zoomDelta;i<n&&(i=n),t.zoomTo(i)},back:function(e){e.zoomTo(this.originZoom)},shortcutCodes:[["metaKey","-"],["ctrlKey","-"]]}),e.registerCommand("resetZoom",{queue:!1,execute:function(e){var t=e.getZoom();this.originZoom=t,e.zoomTo(1)},back:function(e){e.zoomTo(this.originZoom)}}),e.registerCommand("autoFit",{queue:!1,execute:function(e){var t=e.getZoom();this.originZoom=t,e.fitView(5)},back:function(e){e.zoomTo(this.originZoom)}}),e.registerCommand("toFront",{queue:!1,enable:function(e){var t=e.get("selectedItems");return t&&t.length>0},execute:function(e){var t=e.get("selectedItems");if(t&&t.length>0){var a=e.findById(t[0]);a.toFront(),e.paint()}},back:function(e){}}),e.registerCommand("toBack",{queue:!1,enable:function(e){var t=e.get("selectedItems");return t&&t.length>0},execute:function(e){var t=e.get("selectedItems");if(t&&t.length>0){var a=e.findById(t[0]);a.toBack(),e.paint()}},back:function(e){}})}}]),e}(),f=m,v=a("1b95"),y=a("72fb"),b=a("14c8"),x=a("758e"),k=function(){function e(t){Object(d["a"])(this,e),this._cfgs=v(this.getDefaultCfg(),t)}return Object(u["a"])(e,[{key:"getDefaultCfg",value:function(){return{container:null}}},{key:"get",value:function(e){return this._cfgs[e]}},{key:"set",value:function(e,t){this._cfgs[e]=t}},{key:"initPlugin",value:function(e){var t=this;this.set("graph",e);var a=t.getEvents(),n={};y(a,(function(a,s){var i=b(t,a);n[s]=i,e.on(s,i)})),this._events=n,this.initEvents(),this.updateToolbar()}},{key:"getEvents",value:function(){return{afteritemselected:"updateToolbar",aftercommandexecute:"updateToolbar"}}},{key:"initEvents",value:function(){var e=this.get("graph"),t=this.get("container"),a=t.querySelectorAll("div > span[data-command]");y(a,(function(t,a){var n=t.getAttribute("data-command");t.addEventListener("click",(function(t){e.commandEnable(n)&&e.executeCommand(n)}))}))}},{key:"updateToolbar",value:function(){var e=this.get("graph"),t=this.get("container"),a=t.querySelectorAll("div > span[data-command]");y(a,(function(t,a){var n=t.getAttribute("data-command");e.commandEnable(n)?(x(t,{cursor:"pointer"}),x(t.children[0],{color:"#666"}),t.children[0].setAttribute("color","#666")):(x(t,{cursor:"default"}),x(t.children[0],{color:"#bfbfbf"}),t.children[0].setAttribute("color","#bfbfbf"))}))}},{key:"destroyPlugin",value:function(){this.get("canvas").destroy();var e=this.get("container");e.parentNode.removeChild(e)}}]),e}(),_=k,w=a("1b95"),T=a("72fb"),C=a("158c"),S=function(){function e(t){Object(d["a"])(this,e),this._cfgs=w(this.getDefaultCfg(),t)}return Object(u["a"])(e,[{key:"getDefaultCfg",value:function(){return{container:null}}},{key:"get",value:function(e){return this._cfgs[e]}},{key:"set",value:function(e,t){this._cfgs[e]=t}},{key:"initPlugin",value:function(e){var t=this.get("container"),a=C('<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" style="opacity:0"/>'),n=t.querySelectorAll("div > .el-collapse-item > .el-collapse-item__wrap > .el-collapse-item__content > img[data-item]");T(n,(function(t,n){var s=new Function("return "+t.getAttribute("data-item"))();t.addEventListener("dragstart",(function(t){t.dataTransfer.setDragImage(a,0,0),e.set("onDragAddNode",!0),e.set("addModel",s)})),t.addEventListener("dragend",(function(t){e.emit("canvas:mouseup",t),e.set("onDragAddNode",!1),e.set("addModel",null)}))}))}},{key:"destroy",value:function(){this.get("canvas").destroy();var e=this.get("container");e.parentNode.removeChild(e)}}]),e}(),D=S,z=a("1b95"),O=function(){function e(t){Object(d["a"])(this,e),this._cfgs=z(this.getDefaultCfg(),t)}return Object(u["a"])(e,[{key:"getDefaultCfg",value:function(){return{container:null}}},{key:"get",value:function(e){return this._cfgs[e]}},{key:"set",value:function(e,t){this._cfgs[e]=t}},{key:"initPlugin",value:function(e){var t=this.get("container");t.addEventListener("dragover",(function(t){e.emit("canvas:mousemove",t)})),t.addEventListener("dragleave",(function(t){e.emit("canvas:mouseleave",t)}))}},{key:"destroy",value:function(){this.get("canvas").destroy();var e=this.get("container");e.parentNode.removeChild(e)}}]),e}(),A=O,E=function(){var e=this,t=e._self._c;return t("div",{staticClass:"toolbar"},[t("el-tooltip",{attrs:{content:e.i18n["tooltip.undo"],placement:"bottom"}},[t("span",{staticClass:"command",attrs:{"data-command":"undo"}},[t("span",{staticClass:"iconfont icon-undo"})])]),e._v(" "),t("el-tooltip",{attrs:{content:e.i18n["tooltip.redo"],placement:"bottom"}},[t("span",{staticClass:"command",attrs:{"data-command":"redo"}},[t("span",{staticClass:"iconfont icon-redo"})])]),e._v(" "),t("span",{staticClass:"separator"}),e._v(" "),t("el-tooltip",{attrs:{content:e.i18n["tooltip.copy"],placement:"bottom"}},[t("span",{staticClass:"command",attrs:{"data-command":"copy"}},[t("span",{staticClass:"iconfont icon-copy-o"})])]),e._v(" "),t("el-tooltip",{attrs:{content:e.i18n["tooltip.paste"],placement:"bottom"}},[t("span",{staticClass:"command",attrs:{"data-command":"paste"}},[t("span",{staticClass:"iconfont icon-paster-o"})])]),e._v(" "),t("el-tooltip",{attrs:{content:e.i18n["tooltip.delete"],placement:"bottom"}},[t("span",{staticClass:"command",attrs:{"data-command":"delete"}},[t("span",{staticClass:"iconfont icon-delete-o"})])]),e._v(" "),t("span",{staticClass:"separator"}),e._v(" "),t("el-tooltip",{attrs:{content:e.i18n["tooltip.zoomIn"],placement:"bottom"}},[t("span",{staticClass:"command",attrs:{"data-command":"zoomIn"}},[t("span",{staticClass:"iconfont icon-zoom-in-o"})])]),e._v(" "),t("el-tooltip",{attrs:{content:e.i18n["tooltip.zoomOut"],placement:"bottom"}},[t("span",{staticClass:"command",attrs:{"data-command":"zoomOut"}},[t("span",{staticClass:"iconfont icon-zoom-out-o"})])]),e._v(" "),t("el-tooltip",{attrs:{content:e.i18n["tooltip.zoomReset"],placement:"bottom"}},[t("span",{staticClass:"command",attrs:{"data-command":"resetZoom"}},[t("span",{staticClass:"iconfont icon-actual-size-o"})])]),e._v(" "),t("el-tooltip",{attrs:{content:e.i18n["tooltip.autoFit"],placement:"bottom"}},[t("span",{staticClass:"command",attrs:{"data-command":"autoFit"}},[t("span",{staticClass:"iconfont icon-fit"})])]),e._v(" "),t("span",{staticClass:"separator"}),e._v(" "),t("el-tooltip",{attrs:{content:e.i18n["tooltip.toFront"],placement:"bottom"}},[t("span",{staticClass:"command",attrs:{"data-command":"toFront"}},[t("span",{staticClass:"iconfont icon-to-front"})])]),e._v(" "),t("el-tooltip",{attrs:{content:e.i18n["tooltip.toBack"],placement:"bottom"}},[t("span",{staticClass:"command",attrs:{"data-command":"toBack"}},[t("span",{staticClass:"iconfont icon-to-back"})])])],1)},B=[],F={inject:["i18n"]},N=F,j=(a("e7c0"),a("2877")),P=Object(j["a"])(N,E,B,!1,null,"12b37731",null),I=P.exports,M=function(){var e=this,t=e._self._c;return t("div",{staticClass:"itemPanel",style:{height:e.height+"px"}},[t("el-collapse",{model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[t("el-collapse-item",{attrs:{title:e.i18n["conventional"],name:"1"}},[t("img",{staticStyle:{width:"42px",height:"42px","margin-top":"10px"},attrs:{"data-item":"{clazz:'start',size:'30*30',label:''}",src:a("c5d6")}}),e._v(" "),t("div",[e._v(e._s(e.i18n["startEvent"]))]),e._v(" "),t("img",{staticStyle:{width:"80px",height:"44px","margin-top":"10px"},attrs:{"data-item":e.userTaskData,src:a("1bb8")}}),e._v(" "),t("div",[e._v(e._s(e.i18n["userTask"]))]),e._v(" "),t("img",{staticStyle:{width:"80px",height:"44px","margin-top":"10px"},attrs:{"data-item":e.handleNodeData,src:a("0636")}}),e._v(" "),t("div",[e._v(e._s(e.i18n["handleNode"]))]),e._v(" "),t("img",{staticStyle:{width:"42px",height:"42px","margin-top":"10px"},attrs:{"data-item":"{clazz:'end',size:'30*30',label:''}",src:a("974b")}}),e._v(" "),t("div",[e._v(e._s(e.i18n["endEvent"]))])]),e._v(" "),t("el-collapse-item",{attrs:{title:e.i18n["gateway"],name:"3"}},[t("img",{staticStyle:{width:"48px",height:"48px","margin-top":"10px"},attrs:{"data-item":"{clazz:'exclusiveGateway',size:'40*40',label:''}",src:a("2f27")}}),e._v(" "),t("div",[e._v(e._s(e.i18n["exclusiveGateway"]))]),e._v(" "),t("img",{staticStyle:{width:"48px",height:"48px","margin-top":"10px"},attrs:{"data-item":"{clazz:'parallelGateway',size:'40*40',label:''}",src:a("2a9f4")}}),e._v(" "),t("div",[e._v(e._s(e.i18n["parallelGateway"]))])])],1)],1)},L=[],V={inject:["i18n"],props:{height:{type:Number,default:800}},data:function(){return{activeNames:["1","3"],userTaskData:"{clazz:'userTask',size:'80*44',label:'"+this.i18n["userTask"]+"'}",javaTaskData:"{clazz:'javaTask',size:'80*44',label:'"+this.i18n["javaTask"]+"'}",mailTaskData:"{clazz:'mailTask',size:'80*44',label:'"+this.i18n["mailTask"]+"'}",handleNodeData:"{clazz:'receiveTask',size:'80*44',label:'"+this.i18n["handleNode"]+"'}"}}},R=V,X=(a("8a11"),Object(j["a"])(R,M,L,!1,null,null,null)),Y=X.exports,G=function(){var e=this,t=e._self._c;return t("div",{staticClass:"detailPanel",staticStyle:{"overflow-y":"auto","padding-bottom":"10px"},style:{height:e.height+"px"}},["userTask"===e.model.clazz?t("UserTaskDetail",{attrs:{model:e.model,"on-change":e.onChange,"read-only":e.readOnly,users:e.users,roles:e.roles,groups:e.groups,departments:e.departments,tasks:e.tasks,templates:e.templates,"templates-base":e.templatesBase}}):"scriptTask"===e.model.clazz?t("ScriptTaskDetail",{attrs:{model:e.model,"on-change":e.onChange,"read-only":e.readOnly,tasks:e.tasks}}):"receiveTask"===e.model.clazz?t("HandleNodeDetail",{attrs:{model:e.model,"on-change":e.onChange,"read-only":e.readOnly,users:e.users,roles:e.roles,groups:e.groups,departments:e.departments,tasks:e.tasks,templates:e.templates,"templates-base":e.templatesBase}}):"gateway"===e.model.clazz||"exclusiveGateway"===e.model.clazz||"parallelGateway"===e.model.clazz||"inclusiveGateway"===e.model.clazz?t("GatewayDetail",{attrs:{model:e.model,"on-change":e.onChange,"read-only":e.readOnly}}):"start"===e.model.clazz?t("StartEventDetail",{attrs:{model:e.model,users:e.users,"on-change":e.onChange,"read-only":e.readOnly,tasks:e.tasks,templates:e.templates,"templates-base":e.templatesBase}}):"end"===e.model.clazz?t("EndEventDetail",{attrs:{model:e.model,"on-change":e.onChange,"read-only":e.readOnly,tasks:e.tasks,templates:e.templates,"templates-base":e.templatesBase}}):"flow"===e.model.clazz?t("FlowDetail",{attrs:{model:e.model,"on-change":e.onChange,"read-only":e.readOnly}}):e._e()],1)},q=[],Z=(a("6762"),a("2fdb"),function(){var e=this,t=e._self._c;return t("div",{attrs:{"data-clazz":e.model.clazz}},[t("div",{staticClass:"panelTitle"},[e._v(e._s(e.i18n["userTask"]))]),e._v(" "),t("div",{staticClass:"panelBody"},[t("DefaultDetail",{attrs:{model:e.model,"on-change":e.onChange,"read-only":e.readOnly}}),e._v(" "),t("div",{staticClass:"panelRow"},[t("div",[e._v("之后任务：")]),e._v(" "),t("el-select",{staticStyle:{width:"90%","font-size":"12px"},attrs:{size:"small",placeholder:"选择任务",disabled:e.readOnly,value:e.model.task,multiple:!0,filterable:!0},on:{change:function(t){return e.onChange("task",t)}}},e._l(e.tasks,(function(e,a){return t("el-option",{key:a,attrs:{label:e.name,value:e.full_name}})})),1)],1),e._v(" "),t("div",{staticClass:"panelRow"},[t("div",[t("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" "+e._s(e.i18n["userTask.assignType"])+"：")]),e._v(" "),t("el-select",{staticStyle:{width:"90%","font-size":"12px"},attrs:{size:"small",placeholder:e.i18n["userTask.assignType.placeholder"],value:e.model.assignType,disabled:e.readOnly},on:{change:function(t){e.onChange("assignValue",[]),e.onChange("assignType",t),e.onChange("selectedTemplate",""),e.assignmentType()}}},[t("el-option",{key:"person",attrs:{value:"person",label:e.i18n["userTask.assignType.person"]}}),e._v(" "),t("el-option",{key:"role",attrs:{value:"role",label:e.i18n["userTask.assignType.role"]}}),e._v(" "),t("el-option",{key:"department",attrs:{value:"department",label:e.i18n["userTask.assignType.department"]}}),e._v(" "),t("el-option",{key:"variable",attrs:{value:"variable",label:e.i18n["userTask.assignType.variable"]}}),e._v(" "),t("el-option",{key:"template",attrs:{value:"template",label:e.i18n["userTask.assignType.template"]}})],1)],1),e._v(" "),"person"===e.model.assignType?t("div",{staticClass:"panelRow"},[t("div",[t("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" "+e._s(e.i18n["userTask.assignType.person.title"])+"：")]),e._v(" "),t("el-select",{staticStyle:{width:"90%","font-size":"12px"},attrs:{size:"small",placeholder:e.i18n["userTask.assignType.person.placeholder"],disabled:e.readOnly,value:e.model.assignValue,multiple:!0,filterable:!0},on:{change:function(t){e.onChange("assignValue",t),e.getPersons(t)}}},e._l(e.users,(function(e){return t("el-option",{key:e.userId,attrs:{label:""===e.nickName?e.username:e.nickName,value:e.userId}})})),1)],1):e._e(),e._v(" "),"template"===e.model.assignType?t("div",{staticClass:"panelRow"},[t("div",[t("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" "+e._s(e.i18n["userTask.assignType.template.title"])+"：")]),e._v(" "),t("el-select",{staticStyle:{width:"90%","font-size":"12px"},attrs:{size:"small",placeholder:e.i18n["userTask.assignType.template.placeholder"],disabled:e.readOnly,value:e.model.selectedTemplate,multiple:!1,filterable:!0},on:{change:function(t){e.onChange("selectedTemplate",t),e.onChange("assignValue",[]),e.getTemplateInfo(t)}}},e._l(e.templatesBase.filter((function(t){return e.templates.includes(t.id)})),(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),e._v(" "),"template"===e.model.assignType&&e.model.selectedTemplate&&""!==e.model.selectedTemplate?t("div",{staticClass:"panelRow"},[t("div",[t("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" "+e._s(e.i18n["userTask.assignType.template.field"])+"：")]),e._v(" "),t("el-select",{staticStyle:{width:"90%","font-size":"12px"},attrs:{size:"small",placeholder:e.i18n["userTask.assignType.template.field.placeholder"],disabled:e.readOnly,value:e.model.assignValue,multiple:!1,filterable:!0},on:{change:function(t){e.onChange("assignValue",t)}}},e._l(e.fields,(function(e){return t("el-option",{key:e.model,attrs:{label:e.name,value:e.model}})})),1)],1):"role"===e.model.assignType?t("div",{staticClass:"panelRow"},[t("div",[t("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" "+e._s(e.i18n["userTask.assignType.role.title"])+"：")]),e._v(" "),t("el-select",{staticStyle:{width:"90%","font-size":"12px"},attrs:{size:"small",placeholder:e.i18n["userTask.assignType.role.placeholder"],disabled:e.readOnly,multiple:!0},on:{change:function(t){e.onChange("assignValue",t),e.getPersons(t)}},model:{value:e.model.assignValue,callback:function(t){e.$set(e.model,"assignValue",e._n(t))},expression:"model.assignValue"}},e._l(e.roles,(function(e,a){return t("el-option",{key:a,attrs:{label:e.roleName,value:e.roleId}})})),1)],1):"department"===e.model.assignType?t("div",{staticClass:"panelRow"},[t("div",[t("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" "+e._s(e.i18n["userTask.assignType.department.title"])+"：")]),e._v(" "),t("el-select",{staticStyle:{width:"90%","font-size":"12px"},attrs:{size:"small",placeholder:e.i18n["userTask.assignType.department.placeholder"],value:e.model.assignValue,disabled:e.readOnly,multiple:!0,filterable:!0},on:{change:function(t){e.onChange("assignValue",t),e.getPersons(t)}}},e._l(e.departments,(function(e){return t("el-option",{key:e.deptId,attrs:{label:e.deptName,value:e.deptId}})})),1)],1):"variable"===e.model.assignType?t("div",{staticClass:"panelRow"},[t("div",[t("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" "+e._s(e.i18n["userTask.assignType.variable.title"])+"：")]),e._v(" "),t("el-select",{staticStyle:{width:"90%","font-size":"12px"},attrs:{size:"small",placeholder:e.i18n["userTask.assignType.variable.placeholder"],disabled:e.readOnly,multiple:!0,filterable:!0},on:{change:function(t){e.onChange("assignValue",t),e.getPersons(t)}},model:{value:e.model.assignValue,callback:function(t){e.$set(e.model,"assignValue",e._n(t))},expression:"model.assignValue"}},e._l(e.variableOptions,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),e._v(" "),t("div",{staticClass:"panelRow"},[t("el-checkbox",{attrs:{size:"small",disabled:"role"!==e.model.assignType&&"department"!==e.model.assignType&&(void 0===e.model.assignValue||null===e.model.assignValue||e.model.assignValue.length<=1||e.model.activeOrder||e.readOnly),value:e.model.isCounterSign},on:{change:function(t){e.onChange("isCounterSign",t),e.initCounterSign(t)}}},[e._v(e._s(e.i18n["userTask.counterSign"]))]),e._v(" "),t("el-checkbox",{attrs:{size:"small",disabled:void 0===e.model.assignValue||null===e.model.assignValue||e.model.assignValue.length<=1||e.model.isCounterSign||e.readOnly,value:e.model.activeOrder},on:{change:function(t){return e.onChange("activeOrder",t)}}},[e._v(e._s(e.i18n["userTask.activeOrder"]))]),e._v(" "),("role"===e.model.assignType||"department"===e.model.assignType)&&void 0!==e.model.assignValue&&null!==e.model.assignValue&&e.model.assignValue.length>=1&&e.model.isCounterSign?t("el-checkbox",{attrs:{size:"small",value:e.model.fullHandle},on:{change:function(t){return e.onChange("fullHandle",t)}}},[e._v(e._s(e.i18n["userTask.fullHandle"]))]):e._e()],1),e._v(" "),t("NodeDetail",{attrs:{model:e.model,"on-change":e.onChange,"read-only":e.readOnly,templates:e.templates,"templates-base":e.templatesBase,"readonly-preview":!1,users:e.users}})],1)])}),H=[],W=a("c80c"),U=a("75fc"),K=(a("96cf"),a("3b8d")),$=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"panelRow"},[t("div",[t("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" "+e._s(e.i18n["label"])+"：")]),e._v(" "),t("el-input",{staticStyle:{width:"90%","font-size":"12px"},attrs:{disabled:e.readOnly,value:e.model.label,size:"small"},on:{input:function(t){e.onChange("label",t)}}})],1),e._v(" "),t("div",{staticClass:"panelRow"},[e._m(0),e._v(" "),t("el-input",{staticStyle:{width:"90%","font-size":"12px"},attrs:{size:"small",disabled:e.readOnly,value:e.model.sort},on:{input:function(t){e.onChange("sort",t)}}})],1),e._v(" "),t("div",{staticClass:"panelRow"},[t("el-checkbox",{attrs:{size:"small",disabled:e.readOnly,value:!!e.model.isHideNode},on:{change:function(t){return e.onChange("isHideNode",t)}}},[e._v("隐藏节点")]),e._v(" "),t("el-checkbox",{attrs:{size:"small",disabled:e.readOnly,value:!!e.model.hideIcon},on:{change:function(t){return e.onChange("hideIcon",t)}}},[e._v(e._s(e.i18n["hideIcon"]))])],1)])},Q=[function(){var e=this,t=e._self._c;return t("div",[t("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" 顺序：")])}],J={inject:["i18n"],props:{model:{type:Object,default:function(){return{}}},onChange:{type:Function,default:function(){}},readOnly:{type:Boolean,default:!1}}},ee=J,te=Object(j["a"])(ee,$,Q,!1,null,null,null),ae=te.exports,ne=function(){var e=this,t=e._self._c;return t("div",[e.writePreview?t("div",{staticClass:"panelRow"},[t("div",[e._v("可写模版：")]),e._v(" "),t("el-select",{staticStyle:{width:"90%","font-size":"12px"},attrs:{placeholder:"选择模版",disabled:e.readOnly,value:e.model.writeTpls,multiple:!0,filterable:!0,size:"small"},on:{change:function(t){return e.onChange("writeTpls",t)}}},[e._l(e.templatesBase,(function(a,n){return[-1!==e.templates.indexOf(a.id)?t("el-option",{key:n,attrs:{label:a.name,value:a.id}}):e._e()]}))],2)],1):e._e(),e._v(" "),e.readonlyPreview?t("div",{staticClass:"panelRow"},[t("div",[e._v("只读模版：")]),e._v(" "),t("el-select",{staticStyle:{width:"90%","font-size":"12px"},attrs:{placeholder:"选择模版",disabled:e.readOnly,value:e.model.readonlyTpls,multiple:!0,filterable:!0,size:"small"},on:{change:function(t){return e.onChange("readonlyTpls",t)}}},[e._l(e.templatesBase,(function(a,n){return[-1!==e.templates.indexOf(a.id)?t("el-option",{key:n,attrs:{label:a.name,value:a.id}}):e._e()]}))],2)],1):e._e(),e._v(" "),t("div",{staticClass:"panelRow"},[t("div",[e._v("隐藏模版：")]),e._v(" "),t("el-select",{staticStyle:{width:"90%","font-size":"12px"},attrs:{placeholder:"选择模版",disabled:e.readOnly,value:e.model.hideTpls,multiple:!0,filterable:!0,size:"small"},on:{change:function(t){return e.onChange("hideTpls",t)}}},[e._l(e.templatesBase,(function(a,n){return[-1!==e.templates.indexOf(a.id)?t("el-option",{key:n,attrs:{label:a.name,value:a.id}}):e._e()]}))],2)],1),e._v(" "),e.ccPreview?t("div",{staticClass:"panelRow"},[t("div",[e._v("抄送邮件：")]),e._v(" "),t("el-select",{staticStyle:{width:"90%","font-size":"12px"},attrs:{size:"small",placeholder:"请选择抄送人",value:e.model.cc,multiple:!0,filterable:!0},on:{change:function(t){e.onChange("cc",t),e.getPersons(t)}}},e._l(e.users,(function(e){return t("el-option",{key:e.userId,attrs:{label:""===e.nickName?e.username:e.nickName,value:e.userId}})})),1)],1):e._e()])},se=[],ie={inject:["i18n"],props:{model:{type:Object,default:function(){return{}}},onChange:{type:Function,default:function(){}},readOnly:{type:Boolean,default:!1},templates:{type:Array,default:function(){return[]}},templatesBase:{type:Array,default:function(){return[]}},writePreview:{type:Boolean,default:!0},readonlyPreview:{type:Boolean,default:!0},ccPreview:{type:Boolean,default:!0},users:{type:Array,default:function(){return[]}}}},oe=ie,le=Object(j["a"])(oe,ne,se,!1,null,null,null),re=le.exports,ce=a("b775");function de(e){return Object(ce["a"])({url:"/api/v1/tpl/details?template_id=".concat(e),method:"get"})}var ue={inject:["i18n"],components:{DefaultDetail:ae,NodeDetail:re},props:{model:{type:Object,default:function(){return{}}},users:{type:Array,default:function(){return[]}},roles:{type:Array,default:function(){return[]}},groups:{type:Array,default:function(){return[]}},departments:{type:Array,default:function(){return[]}},tasks:{type:Array,default:function(){return[]}},onChange:{type:Function,default:function(){}},readOnly:{type:Boolean,default:!1},templates:{type:Array,default:function(){return[]}},templatesBase:{type:Array,default:function(){return[]}}},data:function(){return{variableOptions:[{value:1,label:"创建者"},{value:2,label:"创建者负责人"}],roleList:[],remoteFunc:{templateInfo:function(){var e=Object(K["a"])(Object(W["a"])().mark((function e(t){var a,n;return Object(W["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,de(this.model.selectedTemplate);case 2:a=e.sent,n=[],a&&"200"===a.code&&n.push.apply(n,Object(U["a"])(a.data.form_structure.list)),t(n);case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},fields:[]}},mounted:function(){var e=this;console.log("mounted"),"template"===this.model.assignType&&de(this.model.selectedTemplate).then((function(t){e.fields=t.data.form_structure.list}))},methods:{getPersons:function(e){(void 0===e||null===e||e.length<=1)&&(this.onChange("activeOrder",!1),this.onChange("isCounterSign",!1))},initCounterSign:function(e){e||this.onChange("fullHandle",!1)},assignmentType:function(){this.onChange("isCounterSign",!1)},getTemplateInfo:function(e){var t=this;de(e).then((function(e){t.fields=e.data.form_structure.list}))}}},pe=ue,he=Object(j["a"])(pe,Z,H,!1,null,null,null),ge=he.exports,me=function(){var e=this,t=e._self._c;return t("div",{attrs:{"data-clazz":e.model.clazz}},[t("div",{staticClass:"panelTitle"},[e._v(e._s(e.i18n["scriptTask"]))]),e._v(" "),t("div",{staticClass:"panelBody"},[t("DefaultDetail",{attrs:{model:e.model,"on-change":e.onChange,"read-only":e.readOnly}}),e._v(" "),t("div",{staticClass:"panelRow"},[t("div",[e._v("类型：")]),e._v(" "),t("el-select",{staticStyle:{width:"90%","font-size":"12px"},attrs:{placeholder:"选择任务类型",disabled:e.readOnly,value:e.model.taskType},on:{change:function(t){return e.onChange("taskType",t)}}},[t("el-option",{attrs:{label:"任务",value:"task"}}),e._v(" "),t("el-option",{attrs:{label:"脚本",value:"script"}})],1)],1),e._v(" "),"script"===e.model.taskType?t("div",{staticClass:"panelRow"},[t("div",[e._v(e._s(e.i18n["scriptTask.script"])+"：")]),e._v(" "),t("el-input",{staticStyle:{width:"90%","font-size":"12px"},attrs:{placeholder:"输入脚本",type:"textarea",rows:4,disabled:e.readOnly,value:e.model.script},on:{input:function(t){e.onChange("script",t)}}})],1):e._e(),e._v(" "),"task"===e.model.taskType?t("div",{staticClass:"panelRow"},[t("div",[e._v("任务：")]),e._v(" "),t("el-select",{staticStyle:{width:"90%","font-size":"12px"},attrs:{placeholder:"选择任务",disabled:e.readOnly,value:e.model.task,multiple:!0,filterable:!0},on:{change:function(t){return e.onChange("task",t)}}},e._l(e.tasks,(function(e,a){return t("el-option",{key:a,attrs:{label:e.name,value:e.full_name}})})),1)],1):e._e()],1)])},fe=[],ve={inject:["i18n"],components:{DefaultDetail:ae},props:{model:{type:Object,default:function(){return{}}},onChange:{type:Function,default:function(){}},tasks:{type:Array,default:function(){return[]}},readOnly:{type:Boolean,default:!1}}},ye=ve,be=Object(j["a"])(ye,me,fe,!1,null,null,null),xe=be.exports,ke=function(){var e=this,t=e._self._c;return t("div",{attrs:{"data-clazz":e.model.clazz}},[t("div",{staticClass:"panelTitle"},[e._v(e._s(e.i18n["handleNode"]))]),e._v(" "),t("div",{staticClass:"panelBody"},[t("DefaultDetail",{attrs:{model:e.model,"on-change":e.onChange,"read-only":e.readOnly}}),e._v(" "),t("div",{staticClass:"panelRow"},[t("div",[e._v("之后任务：")]),e._v(" "),t("el-select",{staticStyle:{width:"90%","font-size":"12px"},attrs:{size:"small",placeholder:"选择任务",disabled:e.readOnly,value:e.model.task,multiple:!0,filterable:!0},on:{change:function(t){return e.onChange("task",t)}}},e._l(e.tasks,(function(e,a){return t("el-option",{key:a,attrs:{label:e.name,value:e.full_name}})})),1)],1),e._v(" "),t("div",{staticClass:"panelRow"},[t("div",[t("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" "+e._s(e.i18n["handleNode.assignType"])+"：")]),e._v(" "),t("el-select",{staticStyle:{width:"90%","font-size":"12px"},attrs:{size:"small",placeholder:e.i18n["handleNode.assignType.placeholder"],value:e.model.assignType,disabled:e.readOnly},on:{change:function(t){e.onChange("assignValue",[]),e.onChange("assignType",t),e.onChange("selectedTemplate",""),e.assignmentType()}}},[t("el-option",{key:"person",attrs:{value:"person",label:e.i18n["handleNode.assignType.person"]}}),e._v(" "),t("el-option",{key:"role",attrs:{value:"role",label:e.i18n["userTask.assignType.role"]}}),e._v(" "),t("el-option",{key:"department",attrs:{value:"department",label:e.i18n["handleNode.assignType.department"]}}),e._v(" "),t("el-option",{key:"variable",attrs:{value:"variable",label:e.i18n["handleNode.assignType.variable"]}}),e._v(" "),t("el-option",{key:"template",attrs:{value:"template",label:e.i18n["userTask.assignType.template"]}})],1)],1),e._v(" "),"person"===e.model.assignType?t("div",{staticClass:"panelRow"},[t("div",[t("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" "+e._s(e.i18n["handleNode.assignType.person.title"])+"：")]),e._v(" "),t("el-select",{staticStyle:{width:"90%","font-size":"12px"},attrs:{size:"small",placeholder:e.i18n["handleNode.assignType.person.placeholder"],disabled:e.readOnly,value:e.model.assignValue,multiple:!0,filterable:!0},on:{change:function(t){e.onChange("assignValue",t),e.getPersons(t)}}},e._l(e.users,(function(e){return t("el-option",{key:e.userId,attrs:{label:""===e.nickName?e.username:e.nickName,value:e.userId}})})),1)],1):e._e(),e._v(" "),"template"===e.model.assignType?t("div",{staticClass:"panelRow"},[t("div",[t("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" "+e._s(e.i18n["userTask.assignType.template.title"])+"：")]),e._v(" "),t("el-select",{staticStyle:{width:"90%","font-size":"12px"},attrs:{size:"small",placeholder:e.i18n["userTask.assignType.template.placeholder"],disabled:e.readOnly,value:e.model.selectedTemplate,multiple:!1,filterable:!0},on:{change:function(t){e.onChange("selectedTemplate",t),e.onChange("assignValue",[]),e.getTemplateInfo(t)}}},e._l(e.templatesBase.filter((function(t){return e.templates.includes(t.id)})),(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),e._v(" "),"template"===e.model.assignType&&e.model.selectedTemplate&&""!==e.model.selectedTemplate?t("div",{staticClass:"panelRow"},[t("div",[t("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" "+e._s(e.i18n["userTask.assignType.template.field"])+"：")]),e._v(" "),t("el-select",{staticStyle:{width:"90%","font-size":"12px"},attrs:{size:"small",placeholder:e.i18n["userTask.assignType.template.field.placeholder"],disabled:e.readOnly,value:e.model.assignValue,multiple:!1,filterable:!0},on:{change:function(t){e.onChange("assignValue",t)}}},e._l(e.fields,(function(e){return t("el-option",{key:e.model,attrs:{label:e.name,value:e.model}})})),1)],1):"role"===e.model.assignType?t("div",{staticClass:"panelRow"},[t("div",[t("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" "+e._s(e.i18n["userTask.assignType.role.title"])+"：")]),e._v(" "),t("el-select",{staticStyle:{width:"90%","font-size":"12px"},attrs:{size:"small",placeholder:e.i18n["userTask.assignType.role.placeholder"],disabled:e.readOnly,multiple:!0},on:{change:function(t){e.onChange("assignValue",t),e.getPersons(t)}},model:{value:e.model.assignValue,callback:function(t){e.$set(e.model,"assignValue",e._n(t))},expression:"model.assignValue"}},e._l(e.roles,(function(e,a){return t("el-option",{key:a,attrs:{label:e.roleName,value:e.roleId}})})),1)],1):"department"===e.model.assignType?t("div",{staticClass:"panelRow"},[t("div",[t("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" "+e._s(e.i18n["userTask.assignType.department.title"])+"：")]),e._v(" "),t("el-select",{staticStyle:{width:"90%","font-size":"12px"},attrs:{size:"small",placeholder:e.i18n["userTask.assignType.department.placeholder"],value:e.model.assignValue,disabled:e.readOnly,multiple:!0,filterable:!0},on:{change:function(t){e.onChange("assignValue",t),e.getPersons(t)}}},e._l(e.departments,(function(e){return t("el-option",{key:e.deptId,attrs:{label:e.deptName,value:e.deptId}})})),1)],1):"variable"===e.model.assignType?t("div",{staticClass:"panelRow"},[t("div",[t("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" "+e._s(e.i18n["handleNode.assignType.variable.title"])+"：")]),e._v(" "),t("el-select",{staticStyle:{width:"90%","font-size":"12px"},attrs:{size:"small",placeholder:e.i18n["handleNode.assignType.variable.placeholder"],disabled:e.readOnly,multiple:!0,filterable:!0},on:{change:function(t){e.onChange("assignValue",t),e.getPersons(t)}},model:{value:e.model.assignValue,callback:function(t){e.$set(e.model,"assignValue",e._n(t))},expression:"model.assignValue"}},e._l(e.variableOptions,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),e._v(" "),t("div",{staticClass:"panelRow"},[t("el-checkbox",{attrs:{size:"small",disabled:"role"!==e.model.assignType&&"department"!==e.model.assignType&&(void 0===e.model.assignValue||null===e.model.assignValue||e.model.assignValue.length<=1||e.model.activeOrder||e.readOnly),value:e.model.isCounterSign},on:{change:function(t){e.onChange("isCounterSign",t),e.initCounterSign(t)}}},[e._v(e._s(e.i18n["handleNode.counterSign"]))]),e._v(" "),t("el-checkbox",{attrs:{size:"small",disabled:void 0===e.model.assignValue||null===e.model.assignValue||e.model.assignValue.length<=1||e.model.isCounterSign||e.readOnly,value:e.model.activeOrder},on:{change:function(t){return e.onChange("activeOrder",t)}}},[e._v(e._s(e.i18n["handleNode.activeOrder"]))]),e._v(" "),("role"===e.model.assignType||"department"===e.model.assignType)&&void 0!==e.model.assignValue&&null!==e.model.assignValue&&e.model.assignValue.length>=1&&e.model.isCounterSign?t("el-checkbox",{attrs:{size:"small",value:e.model.fullHandle},on:{change:function(t){return e.onChange("fullHandle",t)}}},[e._v(e._s(e.i18n["userTask.fullHandle"]))]):e._e()],1),e._v(" "),t("NodeDetail",{attrs:{model:e.model,"on-change":e.onChange,"read-only":e.readOnly,templates:e.templates,"templates-base":e.templatesBase,"readonly-preview":!1,users:e.users}})],1)])},_e=[],we={inject:["i18n"],components:{DefaultDetail:ae,NodeDetail:re},props:{model:{type:Object,default:function(){return{}}},users:{type:Array,default:function(){return[]}},roles:{type:Array,default:function(){return[]}},groups:{type:Array,default:function(){return[]}},departments:{type:Array,default:function(){return[]}},tasks:{type:Array,default:function(){return[]}},onChange:{type:Function,default:function(){}},readOnly:{type:Boolean,default:!1},templates:{type:Array,default:function(){return[]}},templatesBase:{type:Array,default:function(){return[]}}},data:function(){return{variableOptions:[{value:1,label:"创建者"},{value:2,label:"创建者负责人"}],roleList:[],remoteFunc:{templateInfo:function(){var e=Object(K["a"])(Object(W["a"])().mark((function e(t){var a,n;return Object(W["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,de(this.model.selectedTemplate);case 2:a=e.sent,n=[],a&&"200"===a.code&&n.push.apply(n,Object(U["a"])(a.data.form_structure.list)),t(n);case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},fields:[]}},mounted:function(){var e=this;"template"===this.model.assignType&&de(this.model.selectedTemplate).then((function(t){e.fields=t.data.form_structure.list}))},methods:{getPersons:function(e){(void 0===e||null===e||e.length<=1)&&(this.onChange("activeOrder",!1),this.onChange("isCounterSign",!1))},initCounterSign:function(e){e||this.onChange("fullHandle",!1)},assignmentType:function(){this.onChange("isCounterSign",!1)},getTemplateInfo:function(e){var t=this;de(e).then((function(e){t.fields=e.data.form_structure.list}))}}},Te=we,Ce=Object(j["a"])(Te,ke,_e,!1,null,null,null),Se=Ce.exports,De=function(){var e=this,t=e._self._c;return t("div",{attrs:{"data-clazz":e.model.clazz}},[t("div",{staticClass:"panelTitle"},[e._v(e._s("exclusiveGateway"===e.model.clazz||"gateway"===e.model.clazz?e.i18n["exclusiveGateway"]:"parallelGateway"===e.model.clazz?e.i18n["parallelGateway"]:e.i18n["inclusiveGateway"]))]),e._v(" "),t("div",{staticClass:"panelBody"},[t("DefaultDetail",{attrs:{model:e.model,"on-change":e.onChange,"read-only":e.readOnly}})],1)])},ze=[],Oe={inject:["i18n"],components:{DefaultDetail:ae},props:{model:{type:Object,default:function(){return{}}},onChange:{type:Function,default:function(){}},readOnly:{type:Boolean,default:!1}}},Ae=Oe,Ee=Object(j["a"])(Ae,De,ze,!1,null,null,null),Be=Ee.exports,Fe=function(){var e=this,t=e._self._c;return t("div",{attrs:{"data-clazz":e.model.clazz}},[t("div",{staticClass:"panelTitle"},[e._v(e._s(e.i18n["startEvent"]))]),e._v(" "),t("div",{staticClass:"panelBody"},[t("DefaultDetail",{attrs:{model:e.model,"on-change":e.onChange,"read-only":e.readOnly}}),e._v(" "),t("div",{staticClass:"panelRow"},[t("div",[e._v("之后任务：")]),e._v(" "),t("el-select",{staticStyle:{width:"90%","font-size":"12px"},attrs:{placeholder:"选择任务",disabled:e.readOnly,value:e.model.task,multiple:!0,filterable:!0,size:"small"},on:{change:function(t){return e.onChange("task",t)}}},e._l(e.tasks,(function(e,a){return t("el-option",{key:a,attrs:{label:e.name,value:e.full_name}})})),1)],1),e._v(" "),t("NodeDetail",{attrs:{model:e.model,"on-change":e.onChange,"read-only":e.readOnly,templates:e.templates,"templates-base":e.templatesBase,"write-preview":!1,users:e.users}})],1)])},Ne=[],je={inject:["i18n"],components:{DefaultDetail:ae,NodeDetail:re},props:{model:{type:Object,default:function(){return{}}},tasks:{type:Array,default:function(){return[]}},onChange:{type:Function,default:function(){}},readOnly:{type:Boolean,default:!1},templates:{type:Array,default:function(){return[]}},templatesBase:{type:Array,default:function(){return[]}},users:{type:Array,default:function(){return[]}}}},Pe=je,Ie=Object(j["a"])(Pe,Fe,Ne,!1,null,null,null),Me=Ie.exports,Le=function(){var e=this,t=e._self._c;return t("div",{attrs:{"data-clazz":e.model.clazz}},[t("div",{staticClass:"panelTitle"},[e._v(e._s(e.i18n["endEvent"]))]),e._v(" "),t("div",{staticClass:"panelBody"},[t("DefaultDetail",{attrs:{model:e.model,"on-change":e.onChange,"read-only":e.readOnly}}),e._v(" "),t("div",{staticClass:"panelRow"},[t("div",[e._v("之后任务：")]),e._v(" "),t("el-select",{staticStyle:{width:"90%","font-size":"12px"},attrs:{size:"small",placeholder:"选择任务",disabled:e.readOnly,value:e.model.task,multiple:!0,filterable:!0},on:{change:function(t){return e.onChange("task",t)}}},e._l(e.tasks,(function(e,a){return t("el-option",{key:a,attrs:{label:e.name,value:e.full_name}})})),1)],1),e._v(" "),t("NodeDetail",{attrs:{model:e.model,"on-change":e.onChange,"read-only":e.readOnly,templates:e.templates,"templates-base":e.templatesBase,"write-preview":!1,"readonly-preview":!1,"cc-preview":!1}})],1)])},Ve=[],Re={inject:["i18n"],components:{DefaultDetail:ae,NodeDetail:re},props:{model:{type:Object,default:function(){return{}}},tasks:{type:Array,default:function(){return[]}},onChange:{type:Function,default:function(){}},readOnly:{type:Boolean,default:!1},templates:{type:Array,default:function(){return[]}},templatesBase:{type:Array,default:function(){return[]}}}},Xe=Re,Ye=Object(j["a"])(Xe,Le,Ve,!1,null,null,null),Ge=Ye.exports,qe=function(){var e=this,t=e._self._c;return t("div",{attrs:{"data-clazz":e.model.clazz}},[t("div",{staticClass:"panelTitle"},[e._v(e._s(e.i18n["sequenceFlow"]))]),e._v(" "),t("div",{staticClass:"panelBody"},[t("DefaultDetail",{attrs:{model:e.model,"on-change":e.onChange,"read-only":e.readOnly}}),e._v(" "),t("div",{staticClass:"panelRow"},[e._m(0),e._v(" "),t("el-select",{staticStyle:{width:"90%","font-size":"12px"},attrs:{placeholder:"选择流转属性",disabled:e.readOnly,value:e.model.flowProperties},on:{change:function(t){return e.onChange("flowProperties",t)}}},[t("el-option",{attrs:{label:"同意",value:"1"}}),e._v(" "),t("el-option",{attrs:{label:"拒绝",value:"0"}}),e._v(" "),t("el-option",{attrs:{label:"其他",value:"2"}})],1)],1),e._v(" "),t("div",{staticClass:"panelRow"},[t("el-checkbox",{attrs:{size:"small",disabled:e.readOnly,value:e.model.isExecuteTask},on:{change:function(t){return e.onChange("isExecuteTask",t)}}},[e._v("是否执行任务")])],1),e._v(" "),t("div",{staticClass:"panelRow"},[t("div",[e._v(e._s(e.i18n["sequenceFlow.expression"])+"：")]),e._v(" "),t("el-input",{staticStyle:{width:"90%","font-size":"12px"},attrs:{type:"textarea",rows:4,disabled:e.readOnly,value:e.model.conditionExpression},on:{input:function(t){e.onChange("conditionExpression",t)}}})],1)],1)])},Ze=[function(){var e=this,t=e._self._c;return t("div",[t("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" 属性：")])}],He={inject:["i18n"],components:{DefaultDetail:ae},props:{model:{type:Object,default:function(){return{}}},onChange:{type:Function,default:function(){}},readOnly:{type:Boolean,default:!1}}},We=He,Ue=Object(j["a"])(We,qe,Ze,!1,null,null,null),Ke=Ue.exports,$e={inject:["i18n"],components:{UserTaskDetail:ge,ScriptTaskDetail:xe,HandleNodeDetail:Se,GatewayDetail:Be,StartEventDetail:Me,EndEventDetail:Ge,FlowDetail:Ke},props:{height:{type:Number,default:800},model:{type:Object,default:function(){return{}}},signalDefs:{type:Array,default:function(){return[]}},messageDefs:{type:Array,default:function(){return[]}},onChange:{type:Function,default:function(){}},readOnly:{type:Boolean,default:!1},users:{type:Array,default:function(){return[]}},roles:{type:Array,default:function(){return[]}},groups:{type:Array,default:function(){return[]}},departments:{type:Array,default:function(){return[]}},tasks:{type:Array,default:function(){return[]}},templates:{type:Array,default:function(){return[]}},templatesBase:{type:Array,default:function(){return[]}},templateInfos:{type:Array,default:function(){return[]}},fieldInfos:{type:Array,default:function(){return[]}}}},Qe=$e,Je=(a("dc4c"),Object(j["a"])(Qe,G,q,!1,null,null,null)),et=Je.exports,tt={label:"Label",hideIcon:"Hide Icon",userTask:"User Task","userTask.assignType":"Assign Type","userTask.assignType.placeholder":"Select a assign type","userTask.assignType.person":"Person","userTask.assignType.person.title":"Assign Person","userTask.assignType.person.placeholder":"Select assign person","userTask.assignType.persongroup":"Person Group","userTask.assignType.persongroup.title":"Assign Person Group","userTask.assignType.persongroup.placeholder":"Select assign person group","userTask.assignType.custom":"Custom Java Class","userTask.assignType.custom.title":"Java Class Name","userTask.dueDate":"Due Date","userTask.dueDate.placeholder":"Select date","userTask.counterSign":"CounterSign",scriptTask:"Script Task","scriptTask.script":"Script",javaTask:"Java Task","javaTask.javaClass":"Java Class Name",mailTask:"Mail Task","mailTask.to":"To","mailTask.subject":"Subject","mailTask.content":"Content",receiveTask:"Receive Task","receiveTask.waitState":"Wait State","receiveTask.stateValue":"State Value",timerEvent:"Timer Event","timerEvent.cycle":"Cycle","timerEvent.cycle.placeholder":"Select time","timerEvent.duration":"Duration",messageEvent:"Message Event","messageEvent.message":"Message",signalEvent:"Signal Event","signalEvent.signal":"Signal",sequenceFlow:"Sequence Flow","sequenceFlow.expression":"Expression","sequenceFlow.seq":"Sequence","sequenceFlow.reverse":"Reverse",startEvent:"Start Event",endEvent:"End Event",start:"Start Events",end:"End Events",gateway:"Gateway",exclusiveGateway:"Exclusive Gateway",parallelGateway:"Parallel Gateway",inclusiveGateway:"Inclusive Gateway",task:"Task",catch:"Catching Event","tooltip.undo":"Undo","tooltip.redo":"Redo","tooltip.copy":"Copy","tooltip.paste":"Paste","tooltip.delete":"Delete","tooltip.zoomIn":"Zoom In","tooltip.zoomOut":"Zoom Out","tooltip.zoomReset":"Zoom Reset","tooltip.autoFit":"Auto Fit","tooltip.toFront":"To Front Layer","tooltip.toBack":"To Back Layer","tooltip.edit":"Edit",process:"Workflow","process.id":"Workflow ID","process.name":"Workflow Name","process.dataObjs":"Data Objects","process.signalDefs":"Signal Defs","process.messageDefs":"Message Defs","process.dataObjs.id":"Id","process.dataObjs.name":"Name","process.dataObjs.type":"Type","process.dataObjs.defaultValue":"DefaultValue","process.signalDef.scope":"Scope"},at={label:"标题",hideIcon:"隐藏图标",userTask:"审批节点","userTask.assignType":"指派类型","userTask.assignType.placeholder":"选择一个类型","userTask.assignType.person":"人员","userTask.assignType.person.title":"审批人","userTask.assignType.person.placeholder":"选择审批人","userTask.assignType.role":"角色","userTask.assignType.role.title":"审批角色","userTask.assignType.role.placeholder":"选择审批角色","userTask.assignType.persongroup":"人员组","userTask.assignType.persongroup.title":"审批组","userTask.assignType.persongroup.placeholder":"选择审批组","userTask.assignType.custom":"自定义类","userTask.assignType.custom.title":"类名","userTask.assignType.department":"部门","userTask.assignType.department.title":"审批部门","userTask.assignType.department.placeholder":"选择审批部门","userTask.assignType.variable":"变量","userTask.assignType.variable.title":"审批变量","userTask.assignType.variable.placeholder":"选择审批变量","userTask.assignType.template":"模版","userTask.assignType.template.title":"选择模版","userTask.assignType.template.placeholder":"选择模版","userTask.assignType.template.field":"审批人字段","userTask.assignType.template.field.placeholder":"选择审批人","userTask.dueDate":"到期时间","userTask.dueDate.placeholder":"请选择日期","userTask.counterSign":"会签","userTask.activeOrder":"主动接单","userTask.fullHandle":"全员处理","userTask.endorsement":"加签",conventional:"常规节点",handleNode:"处理节点","handleNode.assignType":"指派类型","handleNode.assignType.placeholder":"选择一个类型","handleNode.assignType.person":"人员","handleNode.assignType.person.title":"审批人","handleNode.assignType.person.placeholder":"选择审批人","handleNode.assignType.persongroup":"人员组","handleNode.assignType.persongroup.title":"审批组","handleNode.assignType.persongroup.placeholder":"选择审批组","handleNode.assignType.custom":"自定义类","handleNode.assignType.custom.title":"类名","handleNode.assignType.department":"部门","handleNode.assignType.department.title":"审批部门","handleNode.assignType.department.placeholder":"选择审批部门","handleNode.assignType.variable":"变量","handleNode.assignType.variable.title":"审批变量","handleNode.assignType.variable.placeholder":"选择审批变量","handleNode.dueDate":"到期时间","handleNode.dueDate.placeholder":"请选择日期","handleNode.counterSign":"会签","handleNode.endorsement":"加签","handleNode.activeOrder":"主动接单",scriptTask:"任务节点","scriptTask.script":"脚本",javaTask:"自定义类节点","javaTask.javaClass":"类名",mailTask:"邮件节点","mailTask.to":"收件人","mailTask.subject":"标题","mailTask.content":"内容",receiveTask:"接收节点","receiveTask.waitState":"等待属性","receiveTask.stateValue":"等待值",timerEvent:"定时节点","timerEvent.cycle":"循环时间","timerEvent.cycle.placeholder":"请选择时间","timerEvent.duration":"持续时间",messageEvent:"消息节点","messageEvent.message":"消息名",signalEvent:"信号节点","signalEvent.signal":"信号名",sequenceFlow:"连接线","sequenceFlow.expression":"条件表达式","sequenceFlow.seq":"序号","sequenceFlow.reverse":"反向",startEvent:"开始节点",endEvent:"结束节点",start:"开始事件",end:"结束事件",gateway:"网关",exclusiveGateway:"排他网关",parallelGateway:"并行网关",inclusiveGateway:"包容网关",task:"活动",catch:"捕获事件","tooltip.undo":"撤销","tooltip.redo":"重复","tooltip.copy":"复制","tooltip.paste":"粘贴","tooltip.delete":"删除","tooltip.zoomIn":"缩小","tooltip.zoomOut":"放大","tooltip.zoomReset":"实际大小","tooltip.autoFit":"适应屏幕","tooltip.toFront":"移到上一层","tooltip.toBack":"移到下一层","tooltip.edit":"编辑",process:"流程","process.id":"流程标识","process.name":"流程名称","process.dataObjs":"数据对象","process.signalDefs":"信号定义","process.messageDefs":"消息定义","process.dataObjs.id":"Id","process.dataObjs.name":"名称","process.dataObjs.type":"类型","process.dataObjs.defaultValue":"默认值","process.signalDef.scope":"作用域"},nt={en:tt,zh:at};function st(e){return Object(U["a"])(Array(e)).map((function(e){return" "})).join("")}function it(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=t.id||"flow",s=t.name||"flow",i="";t.dataObjs.forEach((function(e){i+="".concat(st(4),'<dataObject id="').concat(e.id,'" name="').concat(e.name,'" itemSubjectRef="xsd:').concat(e.type,'"></dataObject>\n')}));var o="";t.signalDefs.forEach((function(e){o+="".concat(st(2),'<signal id="').concat(e.id,'" name="').concat(e.name,'" flowable:scope="').concat(e.scope,'"></signal>\n')}));var l="";t.messageDefs.forEach((function(e){l+="".concat(st(2),'<message id="').concat(e.id,'" name="').concat(e.name,'"></message>\n')}));var r="",c="",d="".concat(st(2),'<process id="').concat(n,'" name="').concat(s,'">\n');d+=i,e.nodes.forEach((function(e){switch(r+="".concat(st(6),'<bpmndi:BPMNShape bpmnElement="').concat(e.id,'" id="BPMNShape_').concat(e.id,'">\n')+"".concat(st(8),'<omgdc:Bounds width="').concat(e.size[0],'" height="').concat(e.size[1],'" x="').concat(e.x,'" y="').concat(e.y,'"></omgdc:Bounds>\n')+"".concat(st(6),"</bpmndi:BPMNShape>\n"),e.clazz){case"start":d+="".concat(st(4),'<startEvent id="').concat(e.id,'"></startEvent>\n');break;case"end":d+="".concat(st(4),'<endEvent id="').concat(e.id,'"></endEvent>\n');break;case"userTask":var t="";e.assignValue&&e.assignValue.length>0&&("person"===e.assignType?t+='flowable:candidateUsers="'.concat(e.assignValue.join(","),'"'):"persongroup"===e.assignType&&(t+='flowable:candidateGroups="'.concat(e.assignValue.join(","),'"'))),d+="".concat(st(4),'<userTask id="').concat(e.id,'" name="').concat(e.label,'" ').concat(t,"></userTask>\n");break;case"javaTask":var a="";e.javaClass&&(a='flowable:class="'.concat(e.javaClass,'"')),d+="".concat(st(4),'<serviceTask id="').concat(e.id,'" name="').concat(e.label,'" ').concat(a,"></serviceTask>\n");break;case"scriptTask":var n="";e.script&&(n="".concat(st(6),"<script><![CDATA[").concat(e.script,"]]><\/script>\n")),d+="".concat(st(4),'<scriptTask id="').concat(e.id,'" name="').concat(e.label,'">\n').concat(n).concat(st(4),"</scriptTask>\n");break;case"receiveTask":d+="".concat(st(4),'<receiveTask id="').concat(e.id,'" name="').concat(e.label,'"></receiveTask>\n');break;case"mailTask":var s="".concat(st(8),'<flowable:field name="to">\n');s+="".concat(st(10),"<flowable:string><![CDATA[").concat(e.to,"]]></flowable:string>\n"),s+="".concat(st(8),"</flowable:field>\n");var i="".concat(st(8),'<flowable:field name="subject">\n');i+="".concat(st(10),"<flowable:string><![CDATA[").concat(e.subject,"]]></flowable:string>\n"),i+="".concat(st(8),"</flowable:field>\n");var o="".concat(st(8),'<flowable:field name="text">\n');o+="".concat(st(10),"<flowable:string><![CDATA[").concat(e.content,"]]></flowable:string>\n"),o+="".concat(st(8),"</flowable:field>\n");var l="".concat(st(6),"<extensionElements>\n").concat(s).concat(i).concat(o).concat(st(6),"</extensionElements>\n");d+="".concat(st(4),'<serviceTask id="').concat(e.id,'" name="').concat(e.label,'" flowable:type="mail">\n').concat(l).concat(st(4),"</serviceTask>\n");break;case"timerStart":var c="".concat(st(6),"<timerEventDefinition>\n").concat(st(8),"<timeCycle>").concat(e.cycle,"</timeCycle>\n").concat(st(6),"</timerEventDefinition>\n");d+="".concat(st(4),'<startEvent id="').concat(e.id,'" isInterrupting="false">\n').concat(c).concat(st(4),"</startEvent>\n");break;case"timerCatch":var u="".concat(st(6),"<timerEventDefinition>\n").concat(st(8),"<timeCycle>").concat(e.cycle,"</timeCycle>\n").concat(st(6),"</timerEventDefinition>\n");d+="".concat(st(4),'<intermediateCatchEvent id="').concat(e.id,'">\n').concat(u).concat(st(4),"</intermediateCatchEvent>\n");break;case"signalStart":var p="".concat(st(6),'<signalEventDefinition signalRef="').concat(e.signal,'"></signalEventDefinition>\n');d+="".concat(st(4),'<startEvent id="').concat(e.id,'" isInterrupting="true">\n').concat(p).concat(st(4),"</startEvent>\n");break;case"signalCatch":var h="".concat(st(6),'<signalEventDefinition signalRef="').concat(e.signal,'"></signalEventDefinition>\n');d+="".concat(st(4),'<intermediateCatchEvent id="').concat(e.id,'">\n').concat(h).concat(st(4),"</intermediateCatchEvent>\n");break;case"messageStart":var g="".concat(st(6),'<messageEventDefinition messageRef="').concat(e.message,'"></messageEventDefinition>\n');d+="".concat(st(4),'<startEvent id="').concat(e.id,'" isInterrupting="true">\n').concat(g).concat(st(4),"</startEvent>\n");break;case"messageCatch":var m="".concat(st(6),'<messageEventDefinition messageRef="').concat(e.message,'"></messageEventDefinition>\n');d+="".concat(st(4),'<intermediateCatchEvent id="').concat(e.id,'">\n').concat(m).concat(st(4),"</intermediateCatchEvent>\n");break;case"gateway":d+="".concat(st(4),'<exclusiveGateway id="').concat(e.id,'" name="').concat(e.label,'"></exclusiveGateway>\n');break;case"exclusiveGateway":d+="".concat(st(4),'<exclusiveGateway id="').concat(e.id,'" name="').concat(e.label,'"></exclusiveGateway>\n');break;case"parallelGateway":d+="".concat(st(4),'<parallelGateway id="').concat(e.id,'" name="').concat(e.label,'"></parallelGateway>\n');break;case"inclusiveGateway":d+="".concat(st(4),'<inclusiveGateway id="').concat(e.id,'" name="').concat(e.label,'"></inclusiveGateway>\n');break;default:break}})),e.edges.forEach((function(e){c+="".concat(st(6),'<bpmndi:BPMNEdge bpmnElement="').concat(e.source,"_").concat(e.sourceAnchor,"-").concat(e.target,"_").concat(e.targetAnchor,'" ')+'id="BPMNEdge_'.concat(e.source,"_").concat(e.sourceAnchor,"-").concat(e.target,"_").concat(e.targetAnchor,'">\n')+"".concat(st(8),'<omgdi:waypoint x="').concat(e.startPoint.x,'" y="').concat(e.startPoint.y,'"></omgdi:waypoint>\n')+"".concat(st(8),'<omgdi:waypoint x="').concat(e.endPoint.x,'" y="').concat(e.endPoint.y,'"></omgdi:waypoint>\n')+"".concat(st(6),"</bpmndi:BPMNEdge>\n");var t="";e.coditionExpression&&(t="".concat(st(6),'<conditionExpression xsi:type="tFormalExpression"><![CDATA[').concat(e.coditionExpression,"]]></conditionExpression>\n")),d+="".concat(st(4),'<sequenceFlow id="').concat(e.source,"_").concat(e.sourceAnchor,"-").concat(e.target,"_").concat(e.targetAnchor,'" sourceRef="').concat(e.source,'" targetRef="').concat(e.target,'">').concat(t,"</sequenceFlow>\n")})),d+="".concat(st(2),"</process>\n");var u="".concat(st(2),'<bpmndi:BPMNDiagram id="BPMNDiagram_').concat(n,'">\n')+"".concat(st(4),'<bpmndi:BPMNPlane bpmnElement="').concat(n,'" id="BPMNPlane_').concat(n,'">\n').concat(r).concat(c).concat(st(4),"</bpmndi:BPMNPlane>\n")+"".concat(st(2),"</bpmndi:BPMNDiagram>\n"),p='<?xml version="1.0" encoding="UTF-8"?>\n';if(p+='<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:flowable="http://flowable.org/bpmn" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" typeLanguage="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.w3.org/1999/XPath" targetNamespace="http://www.flowable.org/processdef">\n',p+=o,p+=l,p+=d,p+=u,p+="</definitions>",a){var h=new Blob([p],{type:"application/xml;charset=utf-8;"}),g="".concat(s,".bpmn20.xml"),m=document.createElement("a");if(void 0!==m.download){var f=URL.createObjectURL(h);m.setAttribute("href",f),m.setAttribute("download",g),m.style.visibility="hidden",document.body.appendChild(m),m.click(),document.body.removeChild(m)}}return p}var ot={nodeActivedOutterStyle:{lineWidth:0},groupSelectedOutterStyle:{stroke:"#E0F0FF",lineWidth:2},nodeSelectedOutterStyle:{stroke:"#E0F0FF",lineWidth:2},edgeActivedStyle:{stroke:"#1890FF",strokeOpacity:.92},nodeActivedStyle:{fill:"#F3F9FF",stroke:"#1890FF"},groupActivedStyle:{stroke:"#1890FF"},edgeSelectedStyle:{lineWidth:2,strokeOpacity:.92,stroke:"#A3B1BF"},nodeSelectedStyle:{fill:"#F3F9FF",stroke:"#1890FF",fillOpacity:.4},groupSelectedStyle:{stroke:"#1890FF",fillOpacity:.92},nodeStyle:{stroke:"#CED4D9",fill:"#FFFFFF",shadowOffsetX:0,shadowOffsetY:4,shadowBlur:10,shadowColor:"rgba(13, 26, 38, 0.08)",lineWidth:1,radius:4,strokeOpacity:.7},edgeStyle:{stroke:"#A3B1BF",strokeOpacity:.92,lineWidth:1,lineAppendWidth:8,endArrow:!0},groupBackgroundPadding:[40,10,10,10],groupLabelOffsetX:10,groupLabelOffsetY:10,edgeLabelStyle:{fill:"#666",textAlign:"center",textBaseline:"middle"},edgeLabelRectPadding:4,edgeLabelRectStyle:{fill:"white"},nodeLabelStyle:{fill:"#666",textAlign:"center",textBaseline:"middle"},groupStyle:{stroke:"#CED4D9",radius:4},groupLabelStyle:{fill:"#666",textAlign:"left",textBaseline:"top"},multiSelectRectStyle:{fill:"#1890FF",fillOpacity:.08,stroke:"#1890FF",opacity:.1},dragNodeHoverToGroupStyle:{stroke:"#1890FF",lineWidth:2},dragNodeLeaveFromGroupStyle:{stroke:"#BAE7FF",lineWidth:2},anchorPointStyle:{radius:3.5,fill:"#fff",stroke:"#1890FF",lineAppendWidth:12},anchorHotsoptStyle:{radius:12,fill:"#1890FF",fillOpacity:.25},anchorHotsoptActivedStyle:{radius:14},anchorPointHoverStyle:{radius:4,fill:"#1890FF",fillOpacity:1,stroke:"#1890FF"},nodeControlPointStyle:{radius:4,fill:"#fff",shadowBlur:4,shadowColor:"#666"},edgeControlPointStyle:{radius:6,symbol:"square",lineAppendWidth:6,fillOpacity:0,strokeOpacity:0},nodeSelectedBoxStyle:{stroke:"#C2C2C2"},cursor:{panningCanvas:"-webkit-grabbing",beforePanCanvas:"-webkit-grab",hoverNode:"move",hoverEffectiveAnchor:"crosshair",hoverEdge:"default",hoverGroup:"move",hoverUnEffectiveAnchor:"default",hoverEdgeControllPoint:"crosshair",multiSelect:"crosshair"},nodeDelegationStyle:{stroke:"#1890FF",fill:"#1890FF",fillOpacity:.08,lineDash:[4,4],radius:4,lineWidth:1},edgeDelegationStyle:{stroke:"#1890FF",lineDash:[4,4],lineWidth:1}},lt=a("15e8"),rt=function(e){e.Shape.registerFactory("anchor",{defaultShapeType:"marker"}),e.Shape.registerAnchor("single-anchor",e.Util.mix({},lt,{itemType:"anchor",drawShape:function(e,t){var a=this.shapeType,n=this.getShapeStyle(e),s=t.addShape(a,{attrs:n});return s},setState:function(e,t,a){"active-anchor"===e&&(t?this.update({style:Object(o["a"])({},ot.anchorPointHoverStyle)},a):this.update({style:Object(o["a"])({},ot.anchorPointStyle)},a))}})),e.Shape.registerAnchor("marker",{shapeType:"marker"},"single-anchor")},ct=(a("6c7b"),a("8d21")),dt=function(e,t,a){var n,s=a.addGroup(),i=new ct({type:"anchor",group:s,capture:!1,index:e,isActived:!1,model:{style:Object(o["a"])(Object(o["a"])(Object(o["a"])({},t),ot.anchorPointStyle),{},{cursor:ot.cursor.hoverEffectiveAnchor})}});return i.isAnchor=!0,i.toFront(),i.showHotpot=function(){n=s.addShape("marker",{attrs:Object(o["a"])(Object(o["a"])({},t),ot.anchorHotsoptStyle)}),n.toFront(),i.getKeyShape().toFront()},i.setActived=function(){i.update({style:Object(o["a"])({},ot.anchorPointHoverStyle)})},i.clearActived=function(){i.update({style:Object(o["a"])({},ot.anchorPointStyle)})},i.setHotspotActived=function(e){n&&(e?n.attr(ot.anchorHotsoptActivedStyle):n.attr(ot.anchorHotsoptStyle))},s},ut=dt,pt=[[0,1],[0,2],[1,2],[0,1,1,2],[0,2,1,2],[1,2,1,2],[2,2,1,2],[3,2,1,2],[4,2,1,2]],ht=9,gt=[4,2,1,2],mt=function(e){e.registerNode("base-node",{options:{icon:null,iconStyle:{width:14,height:14,left:0,top:0},style:{fill:"#f9f9f9",stroke:"#bbb",cursor:"default"},stateStyles:{selected:{fill:"#eee"},hover:{cursor:ot.cursor.hoverNode}}},drawAnchor:function(e){var t=e.get("children")[0].getBBox();this.getAnchorPoints().forEach((function(a,n){var s=ut(n,{x:t.minX+t.width*a[0],y:t.minY+t.height*a[1]},e);e.anchorShapes.push(s),e.getAllAnchors=function(){return e.anchorShapes.map((function(e){e.filter((function(e){return e.isAnchor}))}))},e.getAnchor=function(t){return e.anchorShapes.filter((function(e){return e.get("index")===t}))}}))},drawShape:function(e,t){var a=this,n=this.shapeType,s=this.getShapeStyle(e),i=t.addShape(n,{attrs:Object(o["a"])({},s)});if(this.options.icon){var l={x:s.x+this.options.iconStyle.left,y:s.y+this.options.iconStyle.top,width:this.options.iconStyle.width,height:this.options.iconStyle.height};"circle"===n?l={x:s.x-s.r+this.options.iconStyle.left,y:s.y-s.r+this.options.iconStyle.top,width:this.options.iconStyle.width,height:this.options.iconStyle.height}:"path"===n&&(l={x:this.options.iconStyle.left,y:this.options.iconStyle.top,width:this.options.iconStyle.width,height:this.options.iconStyle.height}),t.icon=t.addShape("image",{attrs:Object(o["a"])({img:this.options.icon},l)}),e.hideIcon&&t.icon.hide()}return t.anchorShapes=[],t.showAnchor=function(e){a.drawAnchor(e)},t.clearAnchor=function(e){e.anchorShapes&&e.anchorShapes.forEach((function(e){return e.remove()})),e.anchorShapes=[]},t.clearHotpotActived=function(e){e.anchorShapes&&e.anchorShapes.forEach((function(e){e.isAnchor&&e.setHotspotActived(!1)}))},i},setState:function(e,t,a){var n=a.getContainer();if("show-anchor"===e)t?n.showAnchor(n):n.clearAnchor(n);else if("selected"===e){var s=n.getChildByIndex(0);t?s.attr("fill",this.options.stateStyles.selected.fill):s.attr("fill",this.options.style.fill)}else if("hover"===e){var i=n.getChildByIndex(0),o=n.getChildByIndex(1);t?(i.attr("cursor",this.options.stateStyles.hover.cursor),o&&o.attr("cursor",this.options.stateStyles.hover.cursor)):(i.attr("cursor",this.options.style.cursor),o&&o.attr("cursor",this.options.style.cursor))}},getAnchorPoints:function(){return[[.5,0],[1,.5],[.5,1],[0,.5]]},runAnimate:function(e,t){if(e.active){var a=[],n=0,s=t.getFirst();s.animate({onFrame:function(e){for(var t=0;t<9;t+=ht)a=a.concat(gt);var s={lineDash:pt[n].concat(a)};return n=(n+1)%ht,s},repeat:!0},5e3)}},afterDraw:function(e,t){this.runAnimate(e,t)},afterUpdate:function(e,t){var a=t.get("group").icon;e.hideIcon&&a&&a.get("visible")?a.hide():e.hideIcon||!a||a.get("visible")||a.show()}},"single-shape")},ft=a("1b95"),vt={icon:null,iconStyle:{width:12,height:12,left:2,top:2},style:Object(o["a"])(Object(o["a"])({},ot.nodeStyle),{},{fill:"#E7F7FE",stroke:"#1890FF",cursor:"default"}),stateStyles:{selected:{fill:"#95D6FB"},hover:{cursor:ot.cursor.hoverNode}}},yt={icon:null,iconStyle:{width:20,height:20,left:2,top:2},style:Object(o["a"])(Object(o["a"])({},ot.nodeStyle),{},{fill:"#E8FEFA",stroke:"#13C2C2",cursor:"default"}),stateStyles:{selected:{fill:"#8CE8DE"},hover:{cursor:ot.cursor.hoverNode}}},bt={icon:null,iconStyle:{width:18,height:18,left:6,top:6},style:Object(o["a"])(Object(o["a"])({},ot.nodeStyle),{},{fill:"#FEF7E8",stroke:"#FA8C16",cursor:"default"}),stateStyles:{selected:{fill:"#FCD49A"},hover:{cursor:ot.cursor.hoverNode}}},xt={icon:null,iconStyle:{width:18,height:18,left:6,top:6},style:Object(o["a"])(Object(o["a"])({},ot.nodeStyle),{},{fill:"#EFF7E8",stroke:"#F5222D",cursor:"default"}),stateStyles:{selected:{fill:"#CFD49A"},hover:{cursor:ot.cursor.hoverNode}}},kt={icon:null,iconStyle:{width:20,height:20,left:-10,top:-8},style:Object(o["a"])(Object(o["a"])({},ot.nodeStyle),{},{fill:"#FEF7E8",stroke:"#FA8C16",cursor:"default"}),stateStyles:{selected:{fill:"#FCD49A"},hover:{cursor:ot.cursor.hoverNode}}},_t=function(e){e.registerNode("task-node",{shapeType:"rect",options:Object(o["a"])({},vt),getShapeStyle:function(e){e.size=[80,44];var t=e.size[0],a=e.size[1],n=Object(o["a"])({x:0-t/2,y:0-a/2,width:t,height:a},this.options.style);return n}},"base-node"),e.registerNode("gateway-node",{shapeType:"path",labelPosition:"bottom",options:Object(o["a"])({},yt),getShapeStyle:function(e){e.size=[40,40];var t=e.size[0],a=e.size[1],n=4,s=Object(o["a"])({path:[["M",0-n,0-a/2+n],["Q",0,0-a/2,n,0-a/2+n],["L",t/2-n,0-n],["Q",t/2,0,t/2-n,n],["L",n,a/2-n],["Q",0,a/2,0-n,a/2-n],["L",-t/2+n,n],["Q",-t/2,0,-t/2+n,0-n],["Z"]]},this.options.style);return s}},"base-node"),e.registerNode("exclusive-gateway-node",{afterDraw:function(e,t){t.icon=t.addShape("path",{attrs:{path:[["M",-8,-8],["L",8,8],["Z"],["M",8,-8],["L",-8,8],["Z"]],lineWidth:2,stroke:this.options.style.stroke}}),this.runAnimate(e,t)}},"gateway-node"),e.registerNode("parallel-gateway-node",{afterDraw:function(e,t){t.icon=t.addShape("path",{attrs:{path:[["M",0,-10],["L",0,10],["Z"],["M",-10,0],["L",10,0],["Z"]],lineWidth:2,stroke:this.options.style.stroke}}),this.runAnimate(e,t)}},"gateway-node"),e.registerNode("inclusive-gateway-node",{afterDraw:function(e,t){t.icon=t.addShape("circle",{attrs:{x:0,y:0,r:10,lineWidth:2,stroke:this.options.style.stroke}}),this.runAnimate(e,t)}},"gateway-node"),e.registerNode("start-node",{shapeType:"circle",labelPosition:"bottom",options:Object(o["a"])({},bt),getShapeStyle:function(e){e.size=[30,30];var t=e.size[0],a=Object(o["a"])({x:0,y:0,r:t/2},this.options.style);return a},afterDraw:function(e,t){t.icon=t.addShape("path",{attrs:{path:[["M",-4,-6],["L",6,0],["L",-4,6],["Z"]],fill:this.options.style.stroke,stroke:this.options.style.stroke}})},getAnchorPoints:function(){return[[.5,0],[1,.5],[.5,1]]}},"base-node"),e.registerNode("end-node",{shapeType:"circle",labelPosition:"bottom",options:Object(o["a"])({},xt),getShapeStyle:function(e){e.size=[30,30];var t=e.size[0],a=Object(o["a"])({x:0,y:0,r:t/2},this.options.style);return a},afterDraw:function(e,t){t.icon=t.addShape("path",{attrs:{path:[["M",-4,-4],["L",4,-4],["L",4,4],["L",-4,4],["Z"]],fill:this.options.style.stroke,stroke:this.options.style.stroke}})},getAnchorPoints:function(){return[[.5,0],[.5,1],[0,.5]]}},"base-node"),e.registerNode("catch-node",{shapeType:"path",labelPosition:"bottom",options:Object(o["a"])({},kt),getShapeStyle:function(e){e.size=[50,30];var t=e.size[0],a=e.size[1],n=Object(o["a"])({path:[["M",0,-a/3],["L",t/2,-a/3],["L",0,a/3*2],["L",-t/2,-a/3],["Z"]]},this.options.style);return n},getAnchorPoints:function(){return[[.5,0],[.8,.38],[.5,1],[.2,.38]]}},"base-node"),e.registerNode("user-task-node",{options:ft({},vt,{icon:a("c52e"),style:{fill:"#E7F7FE",stroke:"#1890FF"},stateStyles:{selected:{fill:"#95D6FB"}}})},"task-node"),e.registerNode("script-task-node",{options:ft({},vt,{icon:a("2d36"),style:{fill:"#FFF7E6",stroke:"#FFA940"},stateStyles:{selected:{fill:"#FFE7BA"}}})},"task-node"),e.registerNode("java-task-node",{options:ft({},vt,{icon:a("c4beb"),style:{fill:"#FFF1F0",stroke:"#FF4D4F"},stateStyles:{selected:{fill:"#FFCCC7"}}})},"task-node"),e.registerNode("mail-task-node",{options:ft({},vt,{icon:a("f601"),style:{fill:"#F6FFED",stroke:"#73D13D"},stateStyles:{selected:{fill:"#D9F7BE"}}})},"task-node"),e.registerNode("receive-task-node",{options:ft({},vt,{icon:a("11fe"),style:{fill:"#FFF0F6",stroke:"#FF85C0"},stateStyles:{selected:{fill:"#FFD6E7"}}})},"task-node"),e.registerNode("timer-start-node",{options:ft({},bt,{icon:a("d338")}),afterDraw:function(e,t){this.runAnimate(e,t)}},"start-node"),e.registerNode("message-start-node",{options:ft({},bt,{icon:a("ba02")}),afterDraw:function(e,t){this.runAnimate(e,t)}},"start-node"),e.registerNode("signal-start-node",{options:ft({},bt,{icon:a("31ac")}),afterDraw:function(e,t){this.runAnimate(e,t)}},"start-node"),e.registerNode("timer-catch-node",{options:ft({},kt,{icon:a("d338")})},"catch-node"),e.registerNode("signal-catch-node",{options:ft({},kt,{icon:a("31ac")})},"catch-node"),e.registerNode("message-catch-node",{options:ft({},kt,{icon:a("ba02")})},"catch-node")},wt=(a("20d6"),a("7514"),function(e,t){var a=[];return e.forEach((function(e){a.find((function(a){return a[t]===e[t]}))||a.push(e)})),a}),Tt=function(e){e.registerEdge("flow-polyline-round",{options:{style:Object(o["a"])({},ot.edgeStyle),stateStyles:{selected:{lineWidth:ot.edgeSelectedStyle.lineWidth},hover:{stroke:ot.edgeActivedStyle.stroke}}},setState:function(e,t,a){var n=a.getContainer(),s=n.getChildByIndex(0);"selected"===e?t?(s.attr("lineWidth",this.options.stateStyles.selected.lineWidth),s.attr("stroke",this.options.style.stroke)):s.attr("lineWidth",this.options.style.lineWidth):"hover"===e&&(t?s.attr("stroke",this.options.stateStyles.hover.stroke):s.attr("stroke",this.options.style.stroke))},drawShape:function(e,t){this.group=t;var a=this.getShapeStyle(e),n=t.addShape("path",{className:"edge-shape",attrs:a});return n},drawLabel:function(e,t){var a=e.labelCfg||{},n=this.getLabelStyle(e,a,t),s=t.addShape("text",{attrs:n}),i=s.getBBox();return t.addShape("rect",{className:"edge-labelRect",attrs:{x:i.x-ot.edgeLabelRectPadding/2,y:i.y-ot.edgeLabelRectPadding/2,width:i.width+ot.edgeLabelRectPadding,height:i.height+ot.edgeLabelRectPadding,fill:"#fff",stroke:"#fff"}}),t.toBack(),s.toFront(),s},afterUpdate:function(e,t){var a=t.getContainer().findByClassName("edge-label"),n=t.getContainer().findByClassName("edge-labelRect");if(a){var s=a.getBBox();n.attr({x:s.x-ot.edgeLabelRectPadding/2,y:s.y-ot.edgeLabelRectPadding/2,width:s.width+ot.edgeLabelRectPadding,height:s.height+ot.edgeLabelRectPadding})}},getShapeStyle:function(e){e=this.getPathPoints(e);var t=e.startPoint,a=e.endPoint,n=this.getControlPoints(e),s=[t];n&&(s=s.concat(n)),s.push(a);var i=this.getPath(s),l=this.options.style;return l=e.reverse?Object(o["a"])(Object(o["a"])({},l),{},{lineDash:[1,3]}):Object(o["a"])(Object(o["a"])({},l),{},{lineDash:null}),Object(o["a"])(Object(o["a"])({path:i},l),{},{endArrow:{path:"M 0,0 L -10,-4 S -8 0,-10 4 Z"}})},getPath:function(e){for(var t=[],a=0;a<e.length;a++){var n=e[a];if(0===a)t.push(["M",n.x,n.y]);else if(a===e.length-1)t.push(["L",n.x,n.y]);else{var s=e[a-1],i=e[a+1],o=5;(Math.abs(n.y-s.y)>o||Math.abs(n.x-s.x)>o)&&(s.x===n.x?t.push(["L",n.x,n.y>s.y?n.y-o:n.y+o]):s.y===n.y&&t.push(["L",n.x>s.x?n.x-o:n.x+o,n.y]));var l=Math.abs(n.y-i.y),r=Math.abs(n.x-i.x);l>0&&l<o?o=l:r>0&&r<o&&(o=r),s.x!==i.x&&i.x===n.x?t.push(["Q",n.x,n.y,n.x,n.y>i.y?n.y-o:n.y+o]):s.y!==i.y&&i.y===n.y&&t.push(["Q",n.x,n.y,n.x>i.x?n.x-o:n.x+o,n.y])}}return t},getControlPoints:function(e){return e.sourceNode?this.polylineFinding(e.sourceNode,e.targetNode,e.startPoint,e.endPoint,15):e.controlPoints},getExpandedBBox:function(e,t){return 0===e.width&&0===e.height?e:{centerX:e.centerX,centerY:e.centerY,minX:e.minX-t,minY:e.minY-t,maxX:e.maxX+t,maxY:e.maxY+t,height:e.height+2*t,width:e.width+2*t}},getExpandedPort:function(e,t){return Math.abs(t.x-e.centerX)/e.width>Math.abs(t.y-e.centerY)/e.height?{x:t.x>e.centerX?e.maxX:e.minX,y:t.y}:{x:t.x,y:t.y>e.centerY?e.maxY:e.minY}},combineBBoxes:function(e,t){var a=Math.min(e.minX,t.minX),n=Math.min(e.minY,t.minY),s=Math.max(e.maxX,t.maxX),i=Math.max(e.maxY,t.maxY);return{centerX:(a+s)/2,centerY:(n+i)/2,minX:a,minY:n,maxX:s,maxY:i,height:i-n,width:s-a}},getBBoxFromVertexes:function(e,t){var a=Math.min(e.x,t.x),n=Math.max(e.x,t.x),s=Math.min(e.y,t.y),i=Math.max(e.y,t.y);return{centerX:(a+n)/2,centerY:(s+i)/2,maxX:n,maxY:i,minX:a,minY:s,height:i-s,width:n-a}},vertexOfBBox:function(e){return[{x:e.minX,y:e.minY},{x:e.maxX,y:e.minY},{x:e.maxX,y:e.maxY},{x:e.minX,y:e.maxY}]},crossPointsByLineAndBBox:function(e,t){var a=[];return t.x<e.minX||t.x>e.maxX||(a=a.concat([{x:t.x,y:e.minY},{x:t.x,y:e.maxY}])),t.y<e.minY||t.y>e.maxY||(a=a.concat([{x:e.minX,y:t.y},{x:e.maxX,y:t.y}])),a},getConnectablePoints:function(e,t,a,n){var s=this,i=this.getBBoxFromVertexes(a,n),o=this.combineBBoxes(e,t),l=this.combineBBoxes(e,i),r=this.combineBBoxes(t,i),c=[];c=c.concat(this.vertexOfBBox(l),this.vertexOfBBox(r),this.vertexOfBBox(o));var d={x:o.centerX,y:o.centerY};return[o,l,r,i].forEach((function(e){c=c.concat(s.crossPointsByLineAndBBox(e,d))})),c.push({x:a.x,y:n.y}),c.push({x:n.x,y:a.y}),c},filterConnectablePoints:function(e,t){return e.filter((function(e){return e.x<=t.minX||e.x>=t.maxX||e.y<=t.minY||e.y>=t.maxY}))},AStar:function(e,t,a,n,s){var i,o=this,l=[t],r=[];e=wt(this.fillId(e),"id"),e.push(a);var c=function(){var t;if(l.forEach((function(e,a){e.parent||(e.f=0),t||(t=e),e.f<t.f&&(t=e)})),t.x===a.x&&t.y===a.y)return i=t,"break";l.splice(l.findIndex((function(e){return e.x===t.x&&e.y===t.y})),1),r.push(t);var c=e.filter((function(e){return(e.x===t.x||e.y===t.y)&&!(e.x===t.x&&e.y===t.y)&&!o.crossBBox([n,s],t,e)}));c.forEach((function(e){var n=l.find((function(t){return t.x===e.x&&t.y===e.y})),i=o.getCost(e,t);if(r.find((function(t){return t.x===e.x&&t.y===e.y})));else if(n)e.g>i&&(e.parent=t,e.g=i,e.f=e.g+e.h);else{e.parent=t,e.g=i;var c=o.getCost(e,a);o.crossBBox([s],e,a)&&(c+=s.width/2+s.height/2),e.h=c,e.f=e.g+e.h,l.push(e)}}))};while(l.length>0){var d=c();if("break"===d)break}if(i){var u=[];u.push({x:i.x,y:i.y});while(i.parent)i=i.parent,u.push({x:i.x,y:i.y});return u.reverse()}return[]},crossBBox:function(e,t,a){for(var n=0;n<e.length;n++){var s=e[n];if(t.x===a.x&&s.minX<t.x&&s.maxX>t.x){if(t.y<s.maxY&&a.y>=s.maxY||a.y<s.maxY&&t.y>=s.maxY)return!0}else if(t.y===a.y&&s.minY<t.y&&s.maxY>t.y&&(t.x<s.maxX&&a.x>=s.maxX||a.x<s.maxX&&t.x>=s.maxX))return!0}return!1},getCost:function(e,t){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)},getPointBBox:function(e){return{centerX:e.x,centerY:e.y,minX:e.x,minY:e.y,maxX:e.x,maxY:e.y,height:0,width:0}},fillId:function(e){return e.forEach((function(e){e.id=e.x+"-"+e.y})),e},polylineFinding:function(e,t,a,n,s){var i=e&&e.getBBox()?e.getBBox():this.getPointBBox(a),o=t&&t.getBBox()?t.getBBox():this.getPointBBox(n),l=this.getExpandedBBox(i,s),r=this.getExpandedBBox(o,s),c=this.getExpandedPort(l,a),d=this.getExpandedPort(r,n),u=this.getConnectablePoints(l,r,c,d);u=this.filterConnectablePoints(u,l),u=this.filterConnectablePoints(u,r);var p=this.AStar(u,c,d,l,r);return p}},"polyline")},Ct=function(e){rt(e),mt(e),_t(e),Tt(e)},St=function(e){e.registerBehavior("clickSelected",{getDefaultCfg:function(){return{multiple:!1}},getEvents:function(){return{"node:click":"onClick","edge:click":"onClick","edge:mouseover":"onEdgeMouseOver","edge:mouseleave":"onEdgeMouseLeave","canvas:click":"onCanvasClick","node:mouseover":"onNodeMouseOver"}},onClick:function(e){this._clearSelected(),this.graph.setItemState(e.item,"selected",!0);var t=this.graph.get("selectedItems");t||(t=[]),t=[e.item.get("id")],this.graph.set("selectedItems",t),this.graph.emit("afteritemselected",t)},onNodeMouseOver:function(e){"edit"===this.graph.getCurrentMode()?this.graph.setItemState(e.item,"hover",!0):this.graph.setItemState(e.item,"hover",!1)},onEdgeMouseOver:function(e){"edit"!==this.graph.getCurrentMode()||e.item.hasState("selected")||this.graph.setItemState(e.item,"hover",!0)},onEdgeMouseLeave:function(e){"edit"!==this.graph.getCurrentMode()||e.item.hasState("selected")||this.graph.setItemState(e.item,"hover",!1)},onCanvasClick:function(){this._clearSelected()},_clearSelected:function(){var e=this,t=this.graph.findAllByState("node","selected");t.forEach((function(t){e.graph.setItemState(t,"selected",!1)})),t=this.graph.findAllByState("edge","selected"),t.forEach((function(t){e.graph.setItemState(t,"selected",!1)})),this.graph.set("selectedItems",[]),this.graph.emit("afteritemselected",[])}})},Dt=function(e){e.registerBehavior("deleteItem",{getEvents:function(){return{keydown:"onKeydown","canvas:mouseleave":"onCanvasLeave","canvas:mouseenter":"onCanvasFocus"}},onKeydown:function(e){var t=this.graph.get("selectedItems"),a=this.graph.get("focusGraphWrapper");8===e.keyCode&&t&&t.length>0&&a&&(this.graph.executeCommand?this.graph.executeCommand("delete",{}):this.graph.remove(t[0]),this.graph.set("selectedItems",[]),this.graph.emit("afteritemselected",[]))},onCanvasLeave:function(e){this.graph.set("focusGraphWrapper",!1)},onCanvasFocus:function(){this.graph.set("focusGraphWrapper",!0)}})},zt=function(e){e.registerBehavior("dragNode",{getDefaultCfg:function(){return{updateEdge:!0,delegate:!0,delegateStyle:{},align:!0}},getEvents:function(){return{"node:dragstart":"onDragStart","node:drag":"onDrag","node:dragend":"onDragEnd"}},onDragStart:function(e){this.shouldBegin.call(this,e)&&(this.target=e.item,this.origin={x:e.x,y:e.y})},onDrag:function(e){if(this.origin&&this.get("shouldUpdate").call(this,e)){var t=this.origin,a=this.target.get("model");this.point||(this.point={x:a.x,y:a.y});var n=e.x-t.x+this.point.x,s=e.y-t.y+this.point.y;this.origin={x:e.x,y:e.y},this.point={x:n,y:s},this.delegate&&this._updateDelegate(this.target,n,s)}},onDragEnd:function(e){if(this.shouldEnd.call(this,e)&&this.origin){var t=e.item.get("delegateShape");if(t){var a=t.getBBox(),n=a.x+a.width/2,s=a.y+a.height/2;t.remove(),this.target.set("delegateShape",null),this._updateItem(this.target,{x:n,y:s})}this.point=null,this.origin=null,this.graph.emit("afternodedragend")}},_updateItem:function(e,t){this.graph.executeCommand?this.graph.executeCommand("update",{itemId:e.get("id"),updateModel:t}):this.get("updateEdge")?this.graph.updateItem(e,t):(e.updatePosition(t),this.graph.paint())},_updateDelegate:function(e,t,a){var n=this,s=e.get("delegateShape"),i=e.get("keyShape").getBBox();if(!s){var l=n.graph.get("group"),r=ot.nodeDelegationStyle;s=l.addShape("rect",{attrs:Object(o["a"])({width:i.width,height:i.height,x:t-i.width/2,y:a-i.height/2,nodeId:e.get("id")},r)}),s.set("capture",!1),e.set("delegateShape",s)}s.attr({x:t-i.width/2,y:a-i.height/2}),this.graph.paint(),this.graph.emit("afternodedrag",s)}})},Ot=function(e){e.registerBehavior("dragEdge",{getDefaultCfg:function(){return{updateEdge:!0,delegate:!0,delegateStyle:{},dragEdge:!1}},getEvents:function(){return{"anchor:dragstart":"onDragStart","anchor:drag":"onDrag","anchor:dragend":"onDragEnd","anchor:dragenter":"onDragEnter","anchor:dragleave":"onDragLeave"}},onDragEnter:function(e){this.origin&&(this.sameNode(e)||(e.item.setHotspotActived(!0),this.origin.targetNode=e.target.getParent().getParent().get("item"),this.origin.targetAnchor=e.item.get("index")))},onDragLeave:function(e){this.origin&&(this.sameNode(e)||(e.item.setHotspotActived(!1),this.origin.targetNode=null,this.origin.targetAnchor=null))},onDragStart:function(e){var t=e.target.getParent().getParent().get("item"),a=e.item.get("index"),n=t.getAnchorPoints()[a];this.target=e.item,this.origin={x:n.x,y:n.y,sourceNode:t,sourceAnchor:a},this.dragEdgeBeforeShowAnchor(e),this.graph.set("onDragEdge",!0)},onDrag:function(e){this.origin&&this._updateEdge(this.target,e)},onDragEnd:function(e){if(this.origin){var t=e.item.get("edgeDelegate");t&&(t.remove(),this.target.set("edgeDelegate",null)),this._updateEdge(this.target,e,!0),this.graph.setItemState(this.origin.sourceNode,"show-anchor",!1),this.target=null,this.origin=null,this.graph.set("onDragEdge",!1)}},sameNode:function(e){return"marker"===e.target.type&&e.target.getParent()&&e.target.getParent().getParent().get("item").get("id")===this.origin.sourceNode.get("id")},dragEdgeBeforeShowAnchor:function(e){this.graph.getNodes().forEach((function(e){if("startEvent"!==e.getModel().clazz&&"timerStartEvent"!==e.getModel().clazz&&"messageStartEvent"!==e.getModel().clazz){var t=e.getContainer();t.showAnchor(t),t.anchorShapes.forEach((function(e){return e.get("item").showHotpot()}))}}))},_updateEdge:function(e,t,a){var n=t.x,s=t.y;!this.delegate||a?(this._addEdge(t),this._clearAllAnchor(),this.graph.paint()):this._updateEdgeDelegate(e,n,s)},_updateEdgeDelegate:function(e,t,a){var n=this,s=e.get("edgeDelegate");if(!s){var i=n.graph.get("group");s=i.addShape("line",{attrs:Object(o["a"])({x1:this.origin.x,y1:this.origin.y,x2:t,y2:a},ot.edgeDelegationStyle)}),s.set("capture",!1),e.set("edgeDelegate",s)}s.attr({x2:t,y2:a}),this.graph.paint()},_clearAllAnchor:function(){this.graph.getNodes().forEach((function(e){var t=e.getContainer();t.clearAnchor(t)}))},_addEdge:function(){if(this.origin.targetNode){var e={clazz:"flow",source:this.origin.sourceNode.get("id"),target:this.origin.targetNode.get("id"),sourceAnchor:this.origin.sourceAnchor,targetAnchor:this.origin.targetAnchor};this.graph.executeCommand?this.graph.executeCommand("add",{type:"edge",addModel:e}):this.graph.add("edge",e)}}})},At=(a("28a5"),function(e){e.registerBehavior("dragPanelItemAddNode",{getDefaultCfg:function(){return{}},getEvents:function(){return{"canvas:mousemove":"onMouseMove","canvas:mouseup":"onMouseUp","canvas:mouseleave":"onMouseLeave"}},onMouseMove:function(e){if(this.graph.get("onDragAddNode")){var t=this.graph.get("addDelegateShape"),a=this.graph.get("addModel"),n=parseInt(a.size.split("*")[0]),s=parseInt(a.size.split("*")[1]),i=this.graph.getPointByClient(e.x,e.y),l=i.x,r=i.y;if(!t){var c=this.graph.get("group");t=c.addShape("rect",{attrs:Object(o["a"])({width:n,height:s,x:l-n/2,y:r-s/2},ot.nodeDelegationStyle)}),t.set("capture",!1),this.graph.set("addDelegateShape",t)}t.attr({x:l-n/2,y:r-s/2}),this.graph.paint(),this.graph.emit("afternodedrag",t)}},onMouseUp:function(e){if(this.graph.get("onDragAddNode")){var t=this.graph.getPointByClient(e.clientX,e.clientY);t.x>0&&t.y>0&&this._addNode(t)}},onMouseLeave:function(e){this.graph.get("onDragAddNode")&&(this._clearDelegate(),this.graph.emit("afternodedragend"))},_clearDelegate:function(){if(this.graph.get("onDragAddNode")){var e=this.graph.get("addDelegateShape");e&&(e.remove(),this.graph.set("addDelegateShape",null),this.graph.paint())}},_addNode:function(e){if(this.graph.get("onDragAddNode")){var t=this.graph.get("addModel"),a=t.clazz,n=void 0===a?"userTask":a;t.shape=c(n);var s=(new Date).getTime(),i=n+s,l=e.x,r=e.y;this.graph.executeCommand?this.graph.executeCommand("add",{type:"node",addModel:Object(o["a"])(Object(o["a"])({},t),{},{x:l,y:r,id:i})}):this.graph.add("node",Object(o["a"])(Object(o["a"])({},t),{},{x:l,y:r,id:i}))}}})}),Et=function(e){e.registerBehavior("hoverAnchorActived",{getEvents:function(){return{"anchor:mouseenter":"onAnchorEnter","anchor:mousemove":"onAnchorEnter","anchor:mouseleave":"onAnchorLeave"}},onAnchorEnter:function(e){this.graph.get("onDragEdge")||this.graph.setItemState(e.item,"active-anchor",!0)},onAnchorLeave:function(e){if(!this.graph.get("onDragEdge")){var t=e.item.getContainer().getParent();t&&this.graph.setItemState(e.item,"active-anchor",!1)}}})},Bt=function(e){e.registerBehavior("hoverNodeActived",{getEvents:function(){return{"node:mouseenter":"onNodeEnter","node:mouseleave":"onNodeLeave","anchor:mouseleave":"onAnchorLeave"}},onAnchorLeave:function(e){var t=e.item.getContainer().getParent();t&&!this.graph.get("onDragEdge")&&this.graph.setItemState(t.get("item"),"show-anchor",!1)},onNodeEnter:function(e){var t=e.item.getModel().clazz;"endEvent"===t||this.graph.get("onDragEdge")||this.graph.setItemState(e.item,"show-anchor",!0)},onNodeLeave:function(e){"marker"===e.target.type||this.graph.get("onDragEdge")||this.graph.setItemState(e.item,"show-anchor",!1)}})},Ft=function(e){var t=e.Util,a=t.mix,n=t.each,s=t.vec2;e.registerBehavior("itemAlign",{getDefaultCfg:function(){return{alignLineStyle:{stroke:"#FA8C16",lineWidth:1},tolerance:5,_alignLines:[]}},getEvents:function(){return{afternodedrag:"onDrag",afternodedragend:"onDragEnd"}},onDrag:function(e){this._clearAlignLine(),this._itemAlign(e)},onDragEnd:function(){this._clearAlignLine()},_itemAlign:function(e){var t=this,a=e.getBBox(),s={x:a.x+a.width/2,y:a.y},i={x:a.x+a.width/2,y:a.y+a.height/2},o={x:a.x+a.width/2,y:a.y+a.height},l={x:a.x,y:a.y+a.height/2},r={x:a.x+a.width,y:a.y+a.height/2},c=this.graph.getNodes();n(c,(function(c){var d=[],u=[],p=null,h=c.getBBox();if(n(t.getHorizontalLines(h),(function(e){d.push(t.getDistance(e,s)),d.push(t.getDistance(e,i)),d.push(t.getDistance(e,o))})),n(t.getVerticalLines(h),(function(e){u.push(t.getDistance(e,l)),u.push(t.getDistance(e,i)),u.push(t.getDistance(e,r))})),d.sort((function(e,t){return e.dis-t.dis})),u.sort((function(e,t){return e.dis-t.dis})),d.length>0&&d[0].dis<t.tolerance){e.attr({y:d[0].line[1]-d[0].point.y+a.y}),p={horizontals:[d[0]]};for(var g=1;g<3;g++)d[0].dis===d[g].dis&&p.horizontals.push(d[g])}if(u.length>0&&u[0].dis<t.tolerance){e.attr({x:u[0].line[0]-u[0].point.x+a.x}),p?p.verticals=[u[0]]:p={verticals:[u[0]]};for(var m=1;m<3;m++)u[0].dis===u[m].dis&&p.verticals.push(u[m])}p&&(p.bbox=a,t._addAlignLine(p))}))},_addAlignLine:function(e){var t=this.graph.get("group"),s=e.bbox,i=this.alignLineStyle,o=this._alignLines;e.horizontals&&n(e.horizontals,(function(e){var n,l,r=e.line,c=e.point,d=(r[0]+r[2])/2;c.x<d?(n=c.x-s.width/2,l=Math.max(r[0],r[2])):(n=c.x+s.width/2,l=Math.min(r[0],r[2]));var u=t.addShape("line",{attrs:a({x1:n,y1:r[1],x2:l,y2:r[1]},i),capture:!1});o.push(u)})),e.verticals&&n(e.verticals,(function(e){var n,l,r=e.line,c=e.point,d=(r[1]+r[3])/2;c.y<d?(n=c.y-s.height/2,l=Math.max(r[1],r[3])):(n=c.y+s.height/2,l=Math.min(r[1],r[3]));var u=t.addShape("line",{attrs:a({x1:r[0],y1:n,x2:r[0],y2:l},i),capture:!1});o.push(u)}))},getHorizontalLines:function(e){return[[e.minX,e.minY,e.maxX,e.minY],[e.minX,e.centerY,e.maxX,e.centerY],[e.minX,e.maxY,e.maxX,e.maxY]]},getVerticalLines:function(e){return[[e.minX,e.minY,e.minX,e.maxY],[e.centerX,e.minY,e.centerX,e.maxY],[e.maxX,e.minY,e.maxX,e.maxY]]},getDistance:function(e,t){return{line:e,point:t,dis:this.pointLineDistance(e[0],e[1],e[2],e[3],t.x,t.y)}},pointLineDistance:function(e,t,a,n,i,o){var l=[a-e,n-t];if(s.exactEquals(l,[0,0]))return NaN;var r=[-l[1],l[0]];return s.normalize(r,r),Math.abs(s.dot([i-e,o-t],r))},_clearAlignLine:function(){n(this._alignLines,(function(e){e.remove()})),this._alignLines=[],this.graph.paint()}})},Nt=function(e){St(e),Dt(e),zt(e),Ot(e),At(e),Et(e),Bt(e),Ft(e)};Ct(r.a),Nt(r.a);var jt={name:"WfdVue",components:{ToolbarPanel:I,ItemPanel:Y,DetailPanel:et},provide:function(){return{i18n:nt[this.lang]}},props:{isView:{type:Boolean,default:!1},mode:{type:String,default:"edit"},height:{type:Number,default:800},lang:{type:String,default:"zh"},data:{type:Object,default:function(){return{nodes:[],edges:[]}}},users:{type:Array,default:function(){return[]}},roles:{type:Array,default:function(){return[]}},groups:{type:Array,default:function(){return[]}},departments:{type:Array,default:function(){return[]}},tasks:{type:Array,default:function(){return[]}},templates:{type:Array,default:function(){return[]}},templatesBase:{type:Array,default:function(){return[]}},templateInfos:{type:Array,default:function(){return[]}},fieldInfos:{type:Array,default:function(){return[]}}},data:function(){return{resizeFunc:function(){},selectedModel:{},previous:"",processModel:{id:"",name:"",clazz:"process",dataObjs:[],signalDefs:[],messageDefs:[]},graph:null,cmdPlugin:null}},watch:{data:function(e,t){e!==t&&this.graph&&(this.graph.changeData(this.initShape(t)),this.graph.setMode(this.mode),this.graph.emit("canvas:click"),this.cmdPlugin&&this.cmdPlugin.initPlugin(this.graph),this.isView&&this.graph.fitView(5))}},destroyed:function(){window.removeEventListener("resize",this.resizeFunc),this.graph.getNodes().forEach((function(e){e.getKeyShape().stopAnimate()}))},mounted:function(){var e=this,t=[];if(!this.isView){this.cmdPlugin=new f;var a=new _({container:this.$refs["toolbar"].$el}),n=new D({container:this.$refs["addItemPanel"].$el}),s=new A({container:this.$refs["canvas"]});t=[this.cmdPlugin,a,n,s]}var i=this.$refs["canvas"].offsetWidth;this.graph=new r.a.Graph({plugins:t,container:this.$refs["canvas"],height:this.height,width:i,modes:{default:["drag-canvas","clickSelected"],view:[],edit:["drag-canvas","hoverNodeActived","hoverAnchorActived","dragNode","dragEdge","dragPanelItemAddNode","clickSelected","deleteItem","itemAlign"]},defaultEdge:{shape:"flow-polyline-round"}}),this.graph.saveXML=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return it(e.graph.save(),e.processModel,t)},this.isView?this.graph.setMode("view"):this.graph.setMode(this.mode),this.graph.data(this.initShape(this.data)),this.graph.render(),this.isView&&this.data&&this.data.nodes&&this.graph.fitView(5),this.initEvents()},methods:{initShape:function(e){return e&&e.nodes?{nodes:e.nodes.map((function(e){return Object(o["a"])({shape:c(e.clazz)},e)})),edges:e.edges}:e},verifyProcess:function(e){if(void 0===e.label||null===e.label||""===e.label)return"标题不能为空";if(void 0===e.sort||null===e.sort||""===e.sort)return"顺序不能为空";if("userTask"===e.clazz||"receiveTask"===e.clazz){if(void 0===e.assignType||null===e.assignType||""===e.assignType)return"审批节点或处理节点的处理人类型不能为空";if(void 0===e.assignValue||null===e.assignValue||""===e.assignValue||0===e.assignValue.length)return"审批节点或处理节点的处理人不能为空"}return"flow"!==e.clazz||void 0!==e.flowProperties&&null!==e.flowProperties&&""!==e.flowProperties?"":"流转属性不能为空"},initEvents:function(){var e=this;this.graph.on("afteritemselected",(function(t){if(t&&t.length>0){if(""!==e.previous){var a="",n=e.graph.findById(e.previous[0]);if(void 0!==n){a=Object(o["a"])({},n.getModel());var s=e.verifyProcess(a);if(""!==s)return e.selectedModel=a,void e.$message.error(s)}}var i=e.graph.findById(t[0]);e.selectedModel=Object(o["a"])({},i.getModel()),e.previous=t}else""!==e.previous&&(e.selectedModel=e.processModel)}));var t=this.$refs["canvas"],a=this.graph,n=this.height-1;this.resizeFunc=function(){a.changeSize(t.offsetWidth,n)},window.addEventListener("resize",this.resizeFunc)},onItemCfgChange:function(e,t){var a="";if(a=0!==this.previous.length?[this.previous[0]]:this.graph.get("selectedItems"),a&&a.length>0){var n=this.graph.findById(a[0]);this.graph.executeCommand?this.graph.executeCommand("update",{itemId:a[0],updateModel:Object(i["a"])({},e,t)}):this.graph.updateItem(n,Object(i["a"])({},e,t)),this.selectedModel=Object(o["a"])({},n.getModel())}else{var s=Object(o["a"])(Object(o["a"])({},this.processModel),{},Object(i["a"])({},e,t));this.selectedModel=s,this.processModel=s}}}},Pt=jt,It=(a("bc51"),a("c093"),Object(j["a"])(Pt,n,s,!1,null,"2ca2fab0",null));t["default"]=It.exports},c093:function(e,t,a){"use strict";a("238c")},c4beb:function(e,t,a){e.exports=a.p+"static/web/img/icon_java.d3cc233a.svg"},c52e:function(e,t,a){e.exports=a.p+"static/web/img/icon_user.2b39cf22.svg"},c5d6:function(e,t,a){e.exports=a.p+"static/web/img/start.894f1842.svg"},d338:function(e,t,a){e.exports=a.p+"static/web/img/icon_timer.b4fcbba6.svg"},dc4c:function(e,t,a){"use strict";a("df0a")},df0a:function(e,t,a){},e7c0:function(e,t,a){"use strict";a("6858")},f601:function(e,t,a){e.exports=a.p+"static/web/img/icon_mail.0f68d5c7.svg"}}]);